\begin{tikzpicture}
\begin{axis}[legend style={nodes={scale=0.7, transform shape}}, legend cell align={left}, title={Inference result for M=2}, yticklabel style={/pgf/number format/fixed,
            /pgf/number format/precision=3}, grid={major}, yminorgrids={true}, tick align={outside}, xtick={0.0,0.22872531612703928,0.45745063225407856,0.6861759483811178,0.9149012645081571}, xmin={0.0}, xmax={0.9149012645081571}, scaled y ticks={false}]
    \addplot[ybar interval, fill={blue!15}, forget plot, opacity={0.6}, draw={none}, bar width={5.0e-6}]
        table[row sep={\\}]
        {
            \\
            0.07  0.04  \\
            0.08  0.04  \\
            0.09  0.08  \\
            0.1  0.12  \\
            0.11  0.04  \\
            0.12  0.16  \\
            0.13  0.32  \\
            0.14  0.24  \\
            0.15  0.48  \\
            0.16  0.32  \\
            0.17  0.56  \\
            0.18  1.16  \\
            0.19  0.72  \\
            0.2  1.24  \\
            0.21  0.96  \\
            0.22  1.08  \\
            0.23  1.24  \\
            0.24  1.6  \\
            0.25  1.64  \\
            0.26  2.16  \\
            0.27  3.0  \\
            0.28  5.2  \\
            0.29  4.88  \\
            0.3  6.56  \\
            0.31  7.4  \\
            0.32  7.68  \\
            0.33  7.92  \\
            0.34  7.64  \\
            0.35  6.6  \\
            0.36  4.96  \\
            0.37  3.76  \\
            0.38  2.88  \\
            0.39  2.28  \\
            0.4  2.36  \\
            0.41  1.28  \\
            0.42  1.52  \\
            0.43  0.72  \\
            0.44  1.08  \\
            0.45  1.04  \\
            0.46  0.84  \\
            0.47  0.72  \\
            0.48  0.88  \\
            0.49  0.72  \\
            0.5  0.44  \\
            0.51  0.36  \\
            0.52  0.36  \\
            0.53  0.48  \\
            0.54  0.36  \\
            0.55  0.16  \\
            0.56  0.36  \\
            0.57  0.24  \\
            0.58  0.2  \\
            0.59  0.16  \\
            0.6  0.12  \\
            0.61  0.04  \\
            0.62  0.04  \\
            0.63  0.04  \\
            0.64  0.0  \\
            0.65  0.08  \\
            0.66  0.08  \\
            0.67  0.08  \\
            0.68  0.08  \\
            0.69  0.0  \\
            0.7  0.04  \\
            0.71  0.04  \\
            0.72  0.0  \\
            0.73  0.0  \\
            0.74  0.0  \\
            0.75  0.0  \\
            0.76  0.0  \\
            0.77  0.0  \\
            0.78  0.04  \\
            0.79  0.0  \\
            0.8  0.0  \\
            0.81  0.0  \\
            0.82  0.0  \\
            0.83  0.0  \\
            0.84  0.0  \\
            0.85  0.0  \\
            0.86  0.04  \\
            0.87  0.0  \\
            0.88  0.0  \\
            0.89  0.0  \\
            0.9  0.0  \\
            0.91  0.04  \\
            0.92  0.0  \\
        }
        ;
    \addplot[style={{ultra thick, dotted}}, color={blue}]
        table[row sep={\\}]
        {
            \\
            0.0  0.0  \\
            0.00924142691422381  6.090448677265108e-8  \\
            0.01848285382844762  5.573499905431427e-6  \\
            0.02772428074267143  7.1622018996131e-5  \\
            0.03696570765689524  0.00041201139621103544  \\
            0.046207134571119045  0.0015258392297414153  \\
            0.05544856148534286  0.004276911960982534  \\
            0.06468998839956666  0.009891588651866585  \\
            0.07393141531379048  0.01987446744987691  \\
            0.08317284222801428  0.03586360253218517  \\
            0.09241426914223809  0.059456257442744596  \\
            0.10165569605646191  0.09203574950073182  \\
            0.11089712297068571  0.13462373109827047  \\
            0.12013854988490952  0.18777366966186534  \\
            0.12937997679913332  0.2515126774137374  \\
            0.13862140371335713  0.32533157190629286  \\
            0.14786283062758096  0.4082177224877535  \\
            0.15710425754180476  0.4987219557044072  \\
            0.16634568445602857  0.5950494998632632  \\
            0.17558711137025237  0.6951664944994992  \\
            0.18482853828447618  0.7969237074487381  \\
            0.19406996519869998  0.8982388818954568  \\
            0.20331139211292382  0.9974967974566692  \\
            0.21255281902714762  1.0945711478341387  \\
            0.22179424594137143  1.1931637379122677  \\
            0.23103567285559523  1.3050782207136091  \\
            0.24027709976981904  1.455894342305313  \\
            0.24951852668404284  1.689025668373069  \\
            0.25875995359826665  2.0626451148054388  \\
            0.26800138051249045  2.6343909783228328  \\
            0.27724280742671426  3.4343875343605847  \\
            0.2864842343409381  4.436204382743618  \\
            0.2957256612551619  5.541696369330664  \\
            0.3049670881693857  6.592811790221564  \\
            0.31420851508360953  7.4109446254951  \\
            0.32344994199783333  7.849396876069632  \\
            0.33269136891205714  7.836809994944727  \\
            0.34193279582628094  7.3939443194664065  \\
            0.35117422274050475  6.619566592174636  \\
            0.36041564965472855  5.65495538123388  \\
            0.36965707656895236  4.643371177283575  \\
            0.37889850348317616  3.6989142878312906  \\
            0.38813993039739997  2.8917722881897916  \\
            0.3973813573116238  2.2489718621529464  \\
            0.40662278422584763  1.7649395365513145  \\
            0.41586421114007144  1.415254657008043  \\
            0.42510563805429524  1.1687288088067909  \\
            0.43434706496851905  0.9955547420468842  \\
            0.44358849188274285  0.8714011298184956  \\
            0.45282991879696666  0.7784751035066129  \\
            0.46207134571119046  0.7048437445502713  \\
            0.47131277262541427  0.6430667641840617  \\
            0.48055419953963807  0.5887923634900479  \\
            0.4897956264538619  0.5396160036666136  \\
            0.4990370533680857  0.494272524302494  \\
            0.5082784802823095  0.4521186040450537  \\
            0.5175199071965333  0.41282694116228286  \\
            0.5267613341107571  0.37621791161310275  \\
            0.5360027610249809  0.34217299165555703  \\
            0.5452441879392047  0.3105934044511398  \\
            0.5544856148534285  0.28138221984052453  \\
            0.5637270417676523  0.2544378843382518  \\
            0.5729684686818762  0.2296529529578676  \\
            0.5822098955961  0.20691497443936305  \\
            0.5914513225103238  0.1861081161570878  \\
            0.6006927494245476  0.16711490981948782  \\
            0.6099341763387714  0.1498178671377977  \\
            0.6191756032529953  0.13410087774439577  \\
            0.6284170301672191  0.11985037092921408  \\
            0.6376584570814429  0.10695625081649189  \\
            0.6468998839956667  0.09531262511283405  \\
            0.6561413109098905  0.0848183507626579  \\
            0.6653827378241143  0.07537742003649325  \\
            0.6746241647383381  0.06689920951306037  \\
            0.6838655916525619  0.059298612824605156  \\
            0.6931070185667857  0.05249607622929608  \\
            0.7023484454810095  0.04641755420212202  \\
            0.7115898723952333  0.04099440037557375  \\
            0.7208312993094571  0.03616320736116871  \\
            0.7300727262236809  0.03186560727337998  \\
            0.7393141531379047  0.02804804317879655  \\
            0.7485555800521285  0.024661520217649602  \\
            0.7577970069663523  0.021661343798502836  \\
            0.7670384338805761  0.019006851051628287  \\
            0.7762798607947999  0.016661140640564242  \\
            0.7855212877090237  0.01459080507007243  \\
            0.7947627146232475  0.012765668785793554  \\
            0.8040041415374715  0.011158534628621644  \\
            0.8132455684516953  0.009744940576670028  \\
            0.8224869953659191  0.008502928170745067  \\
            0.8317284222801429  0.007412823566456489  \\
            0.8409698491943667  0.006457031778589948  \\
            0.8502112761085905  0.00561984437259009  \\
            0.8594527030228143  0.004887260605843595  \\
            0.8686941299370381  0.0042468218203452965  \\
            0.8779355568512619  0.0036874587312974946  \\
            0.8871769837654857  0.003199351136874051  \\
            0.8964184106797095  0.002773799487032301  \\
            0.9056598375939333  0.0024031076887446423  \\
            0.9149012645081571  0.002080476486794978  \\
        }
        ;
    \addlegendentry {VI estimation}
    \addplot[style={{thick, solid}}, color={green}]
        table[row sep={\\}]
        {
            \\
            0.0  0.0  \\
            0.00924142691422381  4.908799687335086e-9  \\
            0.01848285382844762  8.586477430084479e-7  \\
            0.02772428074267143  1.595504539962589e-5  \\
            0.03696570765689524  0.00011838720453975035  \\
            0.046207134571119045  0.000531201338324994  \\
            0.05544856148534286  0.0017339548626596685  \\
            0.06468998839956666  0.00454425411880604  \\
            0.07393141531379048  0.01014132077876028  \\
            0.08317284222801428  0.020018006264768958  \\
            0.09241426914223809  0.03586731983288001  \\
            0.10165569605646191  0.05942350834568509  \\
            0.11089712297068571  0.09228424500400217  \\
            0.12013854988490952  0.135740371546335  \\
            0.12937997679913332  0.1906348933068181  \\
            0.13862140371335713  0.2572657544896264  \\
            0.14786283062758096  0.33533919608711343  \\
            0.15710425754180476  0.42397356081668064  \\
            0.16634568445602857  0.5217481747974119  \\
            0.17558711137025237  0.6267898051110049  \\
            0.18482853828447618  0.7368957668988678  \\
            0.19406996519869998  0.8497278279473144  \\
            0.20331139211292382  0.9632205589537849  \\
            0.21255281902714762  1.0765813601622498  \\
            0.22179424594137143  1.1925468169867681  \\
            0.23103567285559523  1.3215102604882007  \\
            0.24027709976981904  1.4870643948023843  \\
            0.24951852668404284  1.7301202662193522  \\
            0.25875995359826665  2.106283829041633  \\
            0.26800138051249045  2.67143514973098  \\
            0.27724280742671426  3.4557612170812675  \\
            0.2864842343409381  4.4353308140745105  \\
            0.2957256612551619  5.516675029667653  \\
            0.3049670881693857  6.54739327673976  \\
            0.31420851508360953  7.353811640939891  \\
            0.32344994199783333  7.791987888880855  \\
            0.33269136891205714  7.790510648156174  \\
            0.34193279582628094  7.367623887370737  \\
            0.35117422274050475  6.618147014566754  \\
            0.36041564965472855  5.679197854245697  \\
            0.36965707656895236  4.690625350156871  \\
            0.37889850348317616  3.7643598163185197  \\
            0.38813993039739997  2.969698497156056  \\
            0.3973813573116238  2.333795775324058  \\
            0.40662278422584763  1.8518457737401723  \\
            0.41586421114007144  1.5004799435591583  \\
            0.42510563805429524  1.24958540048334  \\
            0.43434706496851905  1.0703014806258018  \\
            0.44358849188274285  0.9390517944824922  \\
            0.45282991879696666  0.8386030620758498  \\
            0.46207134571119046  0.7574134797596601  \\
            0.47131277262541427  0.6883025127221141  \\
            0.48055419953963807  0.6270823828019488  \\
            0.4897956264538619  0.5714458863773246  \\
            0.4990370533680857  0.520179978266016  \\
            0.5082784802823095  0.47266311440085074  \\
            0.5175199071965333  0.42856936611220725  \\
            0.5267613341107571  0.3877066214398307  \\
            0.5360027610249809  0.34993436814234435  \\
            0.5452441879392047  0.31512534550949256  \\
            0.5544856148534285  0.28314981391664  \\
            0.5637270417676523  0.25387072502388314  \\
            0.5729684686818762  0.22714373645825028  \\
            0.5822098955961  0.20281911807365147  \\
            0.5914513225103238  0.18074419066520994  \\
            0.6006927494245476  0.1607657123965572  \\
            0.6099341763387714  0.14273198658536007  \\
            0.6191756032529953  0.12649462311802329  \\
            0.6284170301672191  0.11190995283535494  \\
            0.6376584570814429  0.09884012090251289  \\
            0.6468998839956667  0.0871538945121943  \\
            0.6561413109098905  0.0767272222794493  \\
            0.6653827378241143  0.06744358160301375  \\
            0.6746241647383381  0.05919414787021639  \\
            0.6838655916525619  0.05187781643625319  \\
            0.6931070185667857  0.04540110516716246  \\
            0.7023484454810095  0.03967796218076838  \\
            0.7115898723952333  0.03462950035590126  \\
            0.7208312993094571  0.03018367727257599  \\
            0.7300727262236809  0.02627493653570677  \\
            0.7393141531379047  0.022843823947009803  \\
            0.7485555800521285  0.0198365897362012  \\
            0.7577970069663523  0.017204786046318435  \\
            0.7670384338805761  0.014904867084709204  \\
            0.7762798607947999  0.012897797791502482  \\
            0.7855212877090237  0.01114867552807194  \\
            0.7947627146232475  0.009626368133611446  \\
            0.8040041415374715  0.008303170721566009  \\
            0.8132455684516953  0.007154482771827117  \\
            0.8224869953659191  0.0061585064018835  \\
            0.8317284222801429  0.005295966153592627  \\
            0.8409698491943667  0.004549850195824199  \\
            0.8502112761085905  0.0039051725019073535  \\
            0.8594527030228143  0.003348755300774122  \\
            0.8686941299370381  0.0028690309093903875  \\
            0.8779355568512619  0.0024558619202542675  \\
            0.8871769837654857  0.0021003786314347547  \\
            0.8964184106797095  0.0017948325590542425  \\
            0.9056598375939333  0.0015324648556620014  \\
            0.9149012645081571  0.001307388466035761  \\
        }
        ;
    \addlegendentry {EM estimation}
\end{axis}
\end{tikzpicture}
