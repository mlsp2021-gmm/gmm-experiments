\begin{tikzpicture}
\begin{axis}[legend style={nodes={scale=0.7, transform shape}}, legend cell align={left}, title={Inference result for M=2}, yticklabel style={/pgf/number format/fixed,
            /pgf/number format/precision=3}, grid={major}, yminorgrids={true}, tick align={outside}, xtick={0.0,0.22872531612703928,0.45745063225407856,0.6861759483811178,0.9149012645081571}, xmin={0.0}, xmax={0.9149012645081571}, scaled y ticks={false}]
    \addplot[ybar interval, fill={blue!15}, forget plot, opacity={0.6}, draw={none}, bar width={5.0e-6}]
        table[row sep={\\}]
        {
            \\
            0.07  0.04  \\
            0.08  0.04  \\
            0.09  0.08  \\
            0.1  0.12  \\
            0.11  0.04  \\
            0.12  0.16  \\
            0.13  0.32  \\
            0.14  0.24  \\
            0.15  0.48  \\
            0.16  0.32  \\
            0.17  0.56  \\
            0.18  1.16  \\
            0.19  0.72  \\
            0.2  1.24  \\
            0.21  0.96  \\
            0.22  1.08  \\
            0.23  1.24  \\
            0.24  1.6  \\
            0.25  1.64  \\
            0.26  2.16  \\
            0.27  3.0  \\
            0.28  5.2  \\
            0.29  4.88  \\
            0.3  6.56  \\
            0.31  7.4  \\
            0.32  7.68  \\
            0.33  7.92  \\
            0.34  7.64  \\
            0.35  6.6  \\
            0.36  4.96  \\
            0.37  3.76  \\
            0.38  2.88  \\
            0.39  2.28  \\
            0.4  2.36  \\
            0.41  1.28  \\
            0.42  1.52  \\
            0.43  0.72  \\
            0.44  1.08  \\
            0.45  1.04  \\
            0.46  0.84  \\
            0.47  0.72  \\
            0.48  0.88  \\
            0.49  0.72  \\
            0.5  0.44  \\
            0.51  0.36  \\
            0.52  0.36  \\
            0.53  0.48  \\
            0.54  0.36  \\
            0.55  0.16  \\
            0.56  0.36  \\
            0.57  0.24  \\
            0.58  0.2  \\
            0.59  0.16  \\
            0.6  0.12  \\
            0.61  0.04  \\
            0.62  0.04  \\
            0.63  0.04  \\
            0.64  0.0  \\
            0.65  0.08  \\
            0.66  0.08  \\
            0.67  0.08  \\
            0.68  0.08  \\
            0.69  0.0  \\
            0.7  0.04  \\
            0.71  0.04  \\
            0.72  0.0  \\
            0.73  0.0  \\
            0.74  0.0  \\
            0.75  0.0  \\
            0.76  0.0  \\
            0.77  0.0  \\
            0.78  0.04  \\
            0.79  0.0  \\
            0.8  0.0  \\
            0.81  0.0  \\
            0.82  0.0  \\
            0.83  0.0  \\
            0.84  0.0  \\
            0.85  0.0  \\
            0.86  0.04  \\
            0.87  0.0  \\
            0.88  0.0  \\
            0.89  0.0  \\
            0.9  0.0  \\
            0.91  0.04  \\
            0.92  0.0  \\
        }
        ;
    \addplot[style={{ultra thick, dotted}}, color={blue}]
        table[row sep={\\}]
        {
            \\
            0.0  0.0  \\
            0.00924142691422381  8.163065952162163e-9  \\
            0.01848285382844762  1.3499363083947646e-6  \\
            0.02772428074267143  2.425687552423689e-5  \\
            0.03696570765689524  0.00017567096012818998  \\
            0.046207134571119045  0.0007732419416785092  \\
            0.05544856148534286  0.002483981056407603  \\
            0.06468998839956666  0.006420794876914308  \\
            0.07393141531379048  0.014155985794801566  \\
            0.08317284222801428  0.027639062461614874  \\
            0.09241426914223809  0.04903230043443178  \\
            0.10165569605646191  0.08049436895370864  \\
            0.11089712297068571  0.12394867441024768  \\
            0.12013854988490952  0.18087078241258395  \\
            0.12937997679913332  0.25212162951007244  \\
            0.13862140371335713  0.33784398681278366  \\
            0.14786283062758096  0.4374334166184828  \\
            0.15710425754180476  0.5495981511994651  \\
            0.16634568445602857  0.6725417159786483  \\
            0.17558711137025237  0.8043370294885921  \\
            0.18482853828447618  0.9435887548183175  \\
            0.19406996519869998  1.0904504354198163  \\
            0.20331139211292382  1.2479159876499932  \\
            0.21255281902714762  1.4230340327213482  \\
            0.22179424594137143  1.627400400589827  \\
            0.23103567285559523  1.8761734699017611  \\
            0.24027709976981904  2.18512729989078  \\
            0.24951852668404284  2.565940963118105  \\
            0.25875995359826665  3.020792585257345  \\
            0.26800138051249045  3.537969644025302  \\
            0.27724280742671426  4.090240148812711  \\
            0.2864842343409381  4.6370318900429774  \\
            0.2957256612551619  5.130273142660702  \\
            0.3049670881693857  5.5225381235730655  \\
            0.31420851508360953  5.775399709991613  \\
            0.32344994199783333  5.865883153190758  \\
            0.33269136891205714  5.789581719100392  \\
            0.34193279582628094  5.560029286642116  \\
            0.35117422274050475  5.204930696201526  \\
            0.36041564965472855  4.760516520669504  \\
            0.36965707656895236  4.2654842125661325  \\
            0.37889850348317616  3.7557644950250664  \\
            0.38813993039739997  3.2608786568349934  \\
            0.3973813573116238  2.8021244503227107  \\
            0.40662278422584763  2.3923977861742687  \\
            0.41586421114007144  2.0372009704356033  \\
            0.42510563805429524  1.736310119473261  \\
            0.43434706496851905  1.4856312521473345  \\
            0.44358849188274285  1.278905094097116  \\
            0.45282991879696666  1.1090689169587862  \\
            0.46207134571119046  0.969211598645836  \\
            0.47131277262541427  0.8531474332288964  \\
            0.48055419953963807  0.7556829977599558  \\
            0.4897956264538619  0.6726671723439832  \\
            0.4990370533680857  0.600908407536525  \\
            0.5082784802823095  0.5380262111208308  \\
            0.5175199071965333  0.48228363086898846  \\
            0.5267613341107571  0.43242916877719567  \\
            0.5360027610249809  0.38756233825611586  \\
            0.5452441879392047  0.34702739140641403  \\
            0.5544856148534285  0.31033399749800145  \\
            0.5637270417676523  0.27710084535525403  \\
            0.5729684686818762  0.247017261849593  \\
            0.5822098955961  0.21981815941278174  \\
            0.5914513225103238  0.1952683597502961  \\
            0.6006927494245476  0.17315322042480646  \\
            0.6099341763387714  0.15327331574195344  \\
            0.6191756032529953  0.1354416067576764  \\
            0.6284170301672191  0.11948205784619441  \\
            0.6376584570814429  0.10522903393455149  \\
            0.6468998839956667  0.09252707130267561  \\
            0.6561413109098905  0.08123078544582422  \\
            0.6653827378241143  0.07120478772496734  \\
            0.6746241647383381  0.06232354859830781  \\
            0.6838655916525619  0.05447118386524232  \\
            0.6931070185667857  0.0475411617502968  \\
            0.7023484454810095  0.04143593956483006  \\
            0.7115898723952333  0.036066543433930405  \\
            0.7208312993094571  0.03135210585051816  \\
            0.7300727262236809  0.02721937523958079  \\
            0.7393141531379047  0.02360221023520216  \\
            0.7485555800521285  0.02044106953506266  \\
            0.7577970069663523  0.017682506300571228  \\
            0.7670384338805761  0.015278674272128258  \\
            0.7762798607947999  0.013186851142779626  \\
            0.7855212877090237  0.011368983308343168  \\
            0.7947627146232475  0.009791254891501221  \\
            0.8040041415374715  0.008423682911654042  \\
            0.8132455684516953  0.007239739625332529  \\
            0.8224869953659191  0.0062160023747887235  \\
            0.8317284222801429  0.005331830735545419  \\
            0.8409698491943667  0.004569070328290998  \\
            0.8502112761085905  0.0039117823388539015  \\
            0.8594527030228143  0.0033459975558827663  \\
            0.8686941299370381  0.00285949357473017  \\
            0.8779355568512619  0.002441593714966661  \\
            0.8871769837654857  0.0020829861466138445  \\
            0.8964184106797095  0.0017755617067580743  \\
            0.9056598375939333  0.0015122689052627506  \\
            0.9149012645081571  0.0012869846586753611  \\
        }
        ;
    \addlegendentry {VI estimation}
    \addplot[style={{thick, solid}}, color={green}]
        table[row sep={\\}]
        {
            \\
            0.0  0.0  \\
            0.00924142691422381  7.579407568243582e-9  \\
            0.01848285382844762  1.180992373337735e-6  \\
            0.02772428074267143  2.0549470580564962e-5  \\
            0.03696570765689524  0.00014573426623560025  \\
            0.046207134571119045  0.000632030754884597  \\
            0.05544856148534286  0.0020082509305437797  \\
            0.06468998839956666  0.005148357835105153  \\
            0.07393141531379048  0.01127929022783163  \\
            0.08317284222801428  0.02191679415766231  \\
            0.09241426914223809  0.038740128632805584  \\
            0.10165569605646191  0.06342849306128225  \\
            0.11089712297068571  0.09748629769831932  \\
            0.12013854988490952  0.14208249286337749  \\
            0.12937997679913332  0.19792337096165086  \\
            0.13862140371335713  0.2651707532669888  \\
            0.14786283062758096  0.34340999805061273  \\
            0.15710425754180476  0.4316661069039151  \\
            0.16634568445602857  0.528463028850186  \\
            0.17558711137025237  0.6319260151926481  \\
            0.18482853828447618  0.7399540304903898  \\
            0.19406996519869998  0.850566870902359  \\
            0.20331139211292382  0.9626808422975176  \\
            0.21255281902714762  1.0777284472172906  \\
            0.22179424594137143  1.2024801206708735  \\
            0.23103567285559523  1.3527938024384358  \\
            0.24027709976981904  1.5566848957201114  \\
            0.24951852668404284  1.8536825996148347  \\
            0.25875995359826665  2.2873043550333576  \\
            0.26800138051249045  2.889874165049396  \\
            0.27724280742671426  3.6634745984456583  \\
            0.2864842343409381  4.5650585148082055  \\
            0.2957256612551619  5.504392641928456  \\
            0.3049670881693857  6.359077776552618  \\
            0.31420851508360953  7.003244921804831  \\
            0.32344994199783333  7.339897780630765  \\
            0.33269136891205714  7.325034106113208  \\
            0.34193279582628094  6.975471943084038  \\
            0.35117422274050475  6.359344008756063  \\
            0.36041564965472855  5.574713392864184  \\
            0.36965707656895236  4.7248763743739275  \\
            0.37889850348317616  3.8980734426060906  \\
            0.38813993039739997  3.1559082030890027  \\
            0.3973813573116238  2.5308750955128554  \\
            0.40662278422584763  2.03063611603614  \\
            0.41586421114007144  1.6456521415295293  \\
            0.42510563805429524  1.357167478955604  \\
            0.43434706496851905  1.1436615281771196  \\
            0.44358849188274285  0.9850567832648461  \\
            0.45282991879696666  0.864819949065762  \\
            0.46207134571119046  0.7705131297219845  \\
            0.47131277262541427  0.6934296175328981  \\
            0.48055419953963807  0.6278321627942849  \\
            0.4897956264538619  0.5701311898033999  \\
            0.4990370533680857  0.5181765615469497  \\
            0.5082784802823095  0.4707215899406458  \\
            0.5175199071965333  0.42705325891289087  \\
            0.5267613341107571  0.38675533170964277  \\
            0.5360027610249809  0.3495660801829478  \\
            0.5452441879392047  0.3152979198949177  \\
            0.5544856148534285  0.28379486266686244  \\
            0.5637270417676523  0.2549117252197416  \\
            0.5729684686818762  0.22850515909013583  \\
            0.5822098955961  0.20443072378435873  \\
            0.5914513225103238  0.18254281902991504  \\
            0.6006927494245476  0.16269580798343122  \\
            0.6099341763387714  0.14474550234875125  \\
            0.6191756032529953  0.12855062335112769  \\
            0.6284170301672191  0.11397407653996103  \\
            0.6376584570814429  0.10088398700522128  \\
            0.6468998839956667  0.08915449179764551  \\
            0.6561413109098905  0.0786663080066692  \\
            0.6653827378241143  0.06930710308384855  \\
            0.6746241647383381  0.06097169589246345  \\
            0.6838655916525619  0.053562116061571005  \\
            0.6931070185667857  0.04698754712542017  \\
            0.7023484454810095  0.04116417637655083  \\
            0.7115898723952333  0.03601497169890452  \\
            0.7208312993094571  0.031469403042051855  \\
            0.7300727262236809  0.0274631237318753  \\
            0.7393141531379047  0.023937624528579834  \\
            0.7485555800521285  0.020839871259758117  \\
            0.7577970069663523  0.018121934981606705  \\
            0.7670384338805761  0.01574062195422598  \\
            0.7762798607947999  0.01365710925060082  \\
            0.7855212877090237  0.011836590542947554  \\
            0.7947627146232475  0.010247935511720986  \\
            0.8040041415374715  0.008863365387286232  \\
            0.8132455684516953  0.00765814634694748  \\
            0.8224869953659191  0.00661030183538486  \\
            0.8317284222801429  0.005700344339600797  \\
            0.8409698491943667  0.00491102671583929  \\
            0.8502112761085905  0.004227112822102985  \\
            0.8594527030228143  0.003635166943318982  \\
            0.8686941299370381  0.003123361295452209  \\
            0.8779355568512619  0.002681300749592715  \\
            0.8871769837654857  0.0022998638180187067  \\
            0.8964184106797095  0.001971058883296128  \\
            0.9056598375939333  0.0016878946214731842  \\
            0.9149012645081571  0.001444263565166578  \\
        }
        ;
    \addlegendentry {EM estimation}
\end{axis}
\end{tikzpicture}
