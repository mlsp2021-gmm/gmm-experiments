\begin{tikzpicture}
\begin{axis}[legend style={nodes={scale=0.7, transform shape}}, legend cell align={left}, title={Inference result for M=2}, yticklabel style={/pgf/number format/fixed,
            /pgf/number format/precision=3}, grid={major}, yminorgrids={true}, tick align={outside}, xtick={0.0,0.2027401093310128,0.4054802186620256,0.6082203279930384,0.8109604373240512}, xmin={0.0}, xmax={0.8109604373240512}, scaled y ticks={false}]
    \addplot[ybar interval, fill={blue!15}, forget plot, opacity={0.6}, draw={none}, bar width={5.0e-6}]
        table[row sep={\\}]
        {
            \\
            0.04  0.04  \\
            0.05  0.0  \\
            0.06  0.0  \\
            0.07  0.0  \\
            0.08  0.0  \\
            0.09  0.0  \\
            0.1  0.0  \\
            0.11  0.08  \\
            0.12  0.2  \\
            0.13  0.12  \\
            0.14  0.28  \\
            0.15  0.48  \\
            0.16  0.6  \\
            0.17  0.68  \\
            0.18  0.96  \\
            0.19  0.72  \\
            0.2  1.04  \\
            0.21  0.96  \\
            0.22  1.56  \\
            0.23  1.28  \\
            0.24  1.76  \\
            0.25  1.52  \\
            0.26  2.08  \\
            0.27  3.04  \\
            0.28  3.96  \\
            0.29  6.16  \\
            0.3  6.68  \\
            0.31  7.88  \\
            0.32  9.2  \\
            0.33  6.96  \\
            0.34  7.28  \\
            0.35  6.08  \\
            0.36  5.92  \\
            0.37  4.4  \\
            0.38  3.28  \\
            0.39  2.6  \\
            0.4  2.2  \\
            0.41  1.88  \\
            0.42  1.4  \\
            0.43  0.76  \\
            0.44  0.64  \\
            0.45  0.8  \\
            0.46  0.64  \\
            0.47  0.36  \\
            0.48  0.32  \\
            0.49  0.28  \\
            0.5  0.24  \\
            0.51  0.2  \\
            0.52  0.2  \\
            0.53  0.36  \\
            0.54  0.2  \\
            0.55  0.2  \\
            0.56  0.24  \\
            0.57  0.0  \\
            0.58  0.24  \\
            0.59  0.12  \\
            0.6  0.04  \\
            0.61  0.04  \\
            0.62  0.12  \\
            0.63  0.2  \\
            0.64  0.08  \\
            0.65  0.08  \\
            0.66  0.12  \\
            0.67  0.04  \\
            0.68  0.0  \\
            0.69  0.04  \\
            0.7  0.0  \\
            0.71  0.0  \\
            0.72  0.08  \\
            0.73  0.0  \\
            0.74  0.04  \\
            0.75  0.0  \\
            0.76  0.0  \\
            0.77  0.0  \\
            0.78  0.0  \\
            0.79  0.0  \\
            0.8  0.0  \\
            0.81  0.04  \\
            0.82  0.0  \\
        }
        ;
    \addplot[style={{ultra thick, dotted}}, color={blue}]
        table[row sep={\\}]
        {
            \\
            0.0  0.0  \\
            0.00819151956892981  9.091935898965768e-11  \\
            0.01638303913785962  3.7726429266157556e-8  \\
            0.02457455870678943  1.15495054194716e-6  \\
            0.03276607827571924  1.2161505643902667e-5  \\
            0.04095759784464905  7.135799603488118e-5  \\
            0.04914911741357886  0.0002892393237575602  \\
            0.05734063698250867  0.0009082710000601583  \\
            0.06553215655143849  0.0023661027647336685  \\
            0.07372367612036829  0.0053441622640693935  \\
            0.0819151956892981  0.010785522999547962  \\
            0.09010671525822792  0.01987253265200339  \\
            0.09829823482715772  0.033963169178206486  \\
            0.10648975439608753  0.05449296635610608  \\
            0.11468127396501734  0.08285498169755255  \\
            0.12287279353394716  0.12027299382426848  \\
            0.13106431310287697  0.16768302020538717  \\
            0.13925583267180677  0.22563594138986853  \\
            0.14744735224073657  0.2942303248898641  \\
            0.1556388718096664  0.3730802948172732  \\
            0.1638303913785962  0.4613192683177415  \\
            0.172021910947526  0.557637538107276  \\
            0.18021343051645583  0.6603522216806602  \\
            0.18840495008538563  0.7675179587567339  \\
            0.19659646965431543  0.8771185453583252  \\
            0.20478798922324526  0.9874497127240586  \\
            0.21297950879217506  1.0979098092219004  \\
            0.2211710283611049  1.2104944006634855  \\
            0.2293625479300347  1.3321845431456234  \\
            0.2375540674989645  1.4779333458487274  \\
            0.24574558706789432  1.6730648341716152  \\
            0.2539371066368241  1.9529830807830493  \\
            0.26212862620575395  2.3579354885934105  \\
            0.2703201457746837  2.921922675512854  \\
            0.27851166534361355  3.6576638635798386  \\
            0.2867031849125434  4.5426003077990735  \\
            0.29489470448147315  5.512336134315654  \\
            0.303086224050403  6.4662846634722735  \\
            0.3112777436193328  7.285864692954093  \\
            0.3194692631882626  7.860373966575036  \\
            0.3276607827571924  8.112282823205136  \\
            0.33585230232612223  8.013826157384704  \\
            0.344043821895052  7.590233363431706  \\
            0.35223534146398183  6.909907591478905  \\
            0.36042686103291166  6.066056440818548  \\
            0.36861838060184143  5.156136320857371  \\
            0.37680990017077126  4.264775209143284  \\
            0.3850014197397011  3.453463217086524  \\
            0.39319293930863086  2.757548039265475  \\
            0.4013844588775607  2.1889929209886407  \\
            0.4095759784464905  1.742406910437433  \\
            0.41776749801542035  1.4019395398528018  \\
            0.4259590175843501  1.1473322329342797  \\
            0.43415053715327995  0.9582858574223422  \\
            0.4423420567222098  0.8170222206786414  \\
            0.45053357629113955  0.7093541199451964  \\
            0.4587250958600694  0.624744522401593  \\
            0.4669166154289992  0.5558141414982798  \\
            0.475108134997929  0.497643588403299  \\
            0.4832996545668588  0.4470843651551557  \\
            0.49149117413578863  0.4021829773296419  \\
            0.4996826937047184  0.3617482596684521  \\
            0.5078742132736482  0.32505118898463686  \\
            0.5160657328425781  0.29162979809305206  \\
            0.5242572524115079  0.26116948766366493  \\
            0.5324487719804376  0.23343347379996537  \\
            0.5406402915493674  0.20822454979156932  \\
            0.5488318111182973  0.18536535195967505  \\
            0.5570233306872271  0.16468899776062526  \\
            0.5652148502561569  0.14603522469553928  \\
            0.5734063698250867  0.12924925765286874  \\
            0.5815978893940166  0.11418190177414439  \\
            0.5897894089629463  0.10069008640798822  \\
            0.5979809285318761  0.08863748484572218  \\
            0.606172448100806  0.07789504399126111  \\
            0.6143639676697358  0.06834136335734416  \\
            0.6225554872386656  0.05986291305184358  \\
            0.6307470068075954  0.05235410274956308  \\
            0.6389385263765252  0.04571722226258987  \\
            0.647130045945455  0.039862276450507945  \\
            0.6553215655143848  0.03470673640925386  \\
            0.6635130850833146  0.030175226852883687  \\
            0.6717046046522445  0.02619916715962638  \\
            0.6798961242211743  0.022716381063730907  \\
            0.688087643790104  0.01967068760583598  \\
            0.6962791633590338  0.017011483779744343  \\
            0.7044706829279637  0.014693327360137839  \\
            0.7126622024968935  0.01267552666932341  \\
            0.7208537220658233  0.010921742535556854  \\
            0.7290452416347531  0.009399606398740901  \\
            0.7372367612036829  0.008080357415904002  \\
            0.7454282807726127  0.0069385004917115085  \\
            0.7536198003415425  0.005951486390571025  \\
            0.7618113199104724  0.00509941445895622  \\
            0.7700028394794022  0.0043647579822351104  \\
            0.778194359048332  0.003732111803295212  \\
            0.7863858786172617  0.003187961525478886  \\
            0.7945773981861916  0.0027204733959066726  \\
            0.8027689177551214  0.0023193038046300063  \\
            0.8109604373240512  0.0019754272290039548  \\
        }
        ;
    \addlegendentry {VI estimation}
    \addplot[style={{thick, solid}}, color={green}]
        table[row sep={\\}]
        {
            \\
            0.0  0.0  \\
            0.00819151956892981  1.4432088628732463e-9  \\
            0.01638303913785962  2.935399993453773e-7  \\
            0.02457455870678943  5.992565006485787e-6  \\
            0.03276607827571924  4.773044322422933e-5  \\
            0.04095759784464905  0.0002269859817313589  \\
            0.04914911741357886  0.0007789884327179246  \\
            0.05734063698250867  0.002134502832231096  \\
            0.06553215655143849  0.004960252661481809  \\
            0.07372367612036829  0.010163812087865185  \\
            0.0819151956892981  0.018858078747545644  \\
            0.09010671525822792  0.032289316469008164  \\
            0.09829823482715772  0.05173917431056516  \\
            0.10648975439608753  0.07841435285033159  \\
            0.11468127396501734  0.11333793532868208  \\
            0.12287279353394716  0.15725454864879104  \\
            0.13106431310287697  0.2105583347139115  \\
            0.13925583267180677  0.273249000246167  \\
            0.14744735224073657  0.3449176122262046  \\
            0.1556388718096664  0.4247608000493356  \\
            0.1638303913785962  0.5116201574812074  \\
            0.172021910947526  0.6040442263472857  \\
            0.18021343051645583  0.7003771795990258  \\
            0.18840495008538563  0.7988991597323328  \\
            0.19659646965431543  0.8980888866814143  \\
            0.20478798922324526  0.997150984861885  \\
            0.21297950879217506  1.0970146498883278  \\
            0.2211710283611049  1.2019752849050387  \\
            0.2293625479300347  1.3218911958168889  \\
            0.2375540674989645  1.4743086783275534  \\
            0.24574558706789432  1.6852329753685906  \\
            0.2539371066368241  1.9869187992560395  \\
            0.26212862620575395  2.4115331788294556  \\
            0.2703201457746837  2.98104513711459  \\
            0.27851166534361355  3.69577595023668  \\
            0.2867031849125434  4.525666753774125  \\
            0.29489470448147315  5.40840234232097  \\
            0.303086224050403  6.256650304114206  \\
            0.3112777436193328  6.973460352777971  \\
            0.3194692631882626  7.471735258180439  \\
            0.3276607827571924  7.692072620641128  \\
            0.33585230232612223  7.613876307552902  \\
            0.344043821895052  7.2570753713425935  \\
            0.35223534146398183  6.674918526219813  \\
            0.36042686103291166  5.940853381095899  \\
            0.36861838060184143  5.133633894265677  \\
            0.37680990017077126  4.324424961938234  \\
            0.3850014197397011  3.5682734711331983  \\
            0.39319293930863086  2.900611826781997  \\
            0.4013844588775607  2.338067559269426  \\
            0.4095759784464905  1.8820878854724357  \\
            0.41776749801542035  1.523759359262186  \\
            0.4259590175843501  1.248518474343621  \\
            0.43415053715327995  1.0399571669759324  \\
            0.4423420567222098  0.8824196461611116  \\
            0.45053357629113955  0.7624461281860295  \\
            0.4587250958600694  0.669313887131429  \\
            0.4669166154289992  0.5949827278944675  \\
            0.475108134997929  0.5337202369035307  \\
            0.4832996545668588  0.48161040867765376  \\
            0.49149117413578863  0.4360723098272909  \\
            0.4996826937047184  0.3954522061372367  \\
            0.5078742132736482  0.35870925574747653  \\
            0.5160657328425781  0.32519001125380004  \\
            0.5242572524115079  0.29447584245579406  \\
            0.5324487719804376  0.26628484476370895  \\
            0.5406402915493674  0.24041168616441153  \\
            0.5488318111182973  0.2166923958277202  \\
            0.5570233306872271  0.19498475217315026  \\
            0.5652148502561569  0.17515798948040812  \\
            0.5734063698250867  0.15708782421605058  \\
            0.5815978893940166  0.14065437214772253  \\
            0.5897894089629463  0.12574154271769133  \\
            0.5979809285318761  0.11223712152113895  \\
            0.606172448100806  0.10003311932568135  \\
            0.6143639676697358  0.08902617420317921  \\
            0.6225554872386656  0.07911790694108944  \\
            0.6307470068075954  0.07021518963185562  \\
            0.6389385263765252  0.062230317438624935  \\
            0.647130045945455  0.05508108784647261  \\
            0.6553215655143848  0.0486907978565917  \\
            0.6635130850833146  0.042988171637962626  \\
            0.6717046046522445  0.03790723123179272  \\
            0.6798961242211743  0.03338712208155324  \\
            0.688087643790104  0.029371903969336356  \\
            0.6962791633590338  0.02581031663823627  \\
            0.7044706829279637  0.02265552809571153  \\
            0.7126622024968935  0.01986487238285827  \\
            0.7208537220658233  0.01739958248490065  \\
            0.7290452416347531  0.015224523058309382  \\
            0.7372367612036829  0.013307926760776394  \\
            0.7454282807726127  0.01162113718835691  \\
            0.7536198003415425  0.010138360743582809  \\
            0.7618113199104724  0.00883642917207976  \\
            0.7700028394794022  0.007694574005343075  \\
            0.778194359048332  0.0066942137257478985  \\
            0.7863858786172617  0.005818754118524088  \\
            0.7945773981861916  0.005053401986475701  \\
            0.8027689177551214  0.004384992169199161  \\
            0.8109604373240512  0.003801827622438283  \\
        }
        ;
    \addlegendentry {EM estimation}
\end{axis}
\end{tikzpicture}
