\begin{tikzpicture}
\begin{axis}[legend style={nodes={scale=0.7, transform shape}}, legend cell align={left}, title={Inference result for M=2}, yticklabel style={/pgf/number format/fixed,
            /pgf/number format/precision=3}, grid={major}, yminorgrids={true}, tick align={outside}, xtick={0.0,0.20226171327560827,0.40452342655121654,0.6067851398268248,0.8090468531024331}, xmin={0.0}, xmax={0.8090468531024331}, scaled y ticks={false}]
    \addplot[ybar interval, fill={blue!15}, forget plot, opacity={0.6}, draw={none}, bar width={5.0e-6}]
        table[row sep={\\}]
        {
            \\
            0.04  0.04  \\
            0.05  0.0  \\
            0.06  0.0  \\
            0.07  0.04  \\
            0.08  0.0  \\
            0.09  0.04  \\
            0.1  0.04  \\
            0.11  0.04  \\
            0.12  0.16  \\
            0.13  0.2  \\
            0.14  0.44  \\
            0.15  0.4  \\
            0.16  0.76  \\
            0.17  0.76  \\
            0.18  1.04  \\
            0.19  1.4  \\
            0.2  0.96  \\
            0.21  1.44  \\
            0.22  1.52  \\
            0.23  1.52  \\
            0.24  1.88  \\
            0.25  2.72  \\
            0.26  2.12  \\
            0.27  3.24  \\
            0.28  4.36  \\
            0.29  5.72  \\
            0.3  6.48  \\
            0.31  6.52  \\
            0.32  6.84  \\
            0.33  7.68  \\
            0.34  6.16  \\
            0.35  5.92  \\
            0.36  4.48  \\
            0.37  4.28  \\
            0.38  2.84  \\
            0.39  2.6  \\
            0.4  1.92  \\
            0.41  1.12  \\
            0.42  1.44  \\
            0.43  1.16  \\
            0.44  0.92  \\
            0.45  1.16  \\
            0.46  0.8  \\
            0.47  1.12  \\
            0.48  0.72  \\
            0.49  0.32  \\
            0.5  0.84  \\
            0.51  0.6  \\
            0.52  0.32  \\
            0.53  0.2  \\
            0.54  0.16  \\
            0.55  0.24  \\
            0.56  0.32  \\
            0.57  0.4  \\
            0.58  0.2  \\
            0.59  0.16  \\
            0.6  0.2  \\
            0.61  0.28  \\
            0.62  0.12  \\
            0.63  0.04  \\
            0.64  0.08  \\
            0.65  0.12  \\
            0.66  0.04  \\
            0.67  0.08  \\
            0.68  0.0  \\
            0.69  0.08  \\
            0.7  0.0  \\
            0.71  0.12  \\
            0.72  0.0  \\
            0.73  0.04  \\
            0.74  0.0  \\
            0.75  0.0  \\
            0.76  0.0  \\
            0.77  0.0  \\
            0.78  0.0  \\
            0.79  0.0  \\
            0.8  0.04  \\
            0.81  0.0  \\
        }
        ;
    \addplot[style={{ultra thick, dotted}}, color={blue}]
        table[row sep={\\}]
        {
            \\
            0.0  0.0  \\
            0.008172190435378111  5.364468736113577e-9  \\
            0.016344380870756223  7.383870992361691e-7  \\
            0.024516571306134334  1.2116281120694037e-5  \\
            0.032688761741512445  8.323077886687022e-5  \\
            0.04086095217689056  0.00035479885449055473  \\
            0.04903314261226867  0.0011184373876461822  \\
            0.05720533304764678  0.002862805227901854  \\
            0.06537752348302489  0.00629171107159974  \\
            0.07354971391840301  0.012307840823059149  \\
            0.08172190435378111  0.021963902021779873  \\
            0.08989409478915923  0.0363888320110187  \\
            0.09806628522453734  0.05669978891720165  \\
            0.10623847565991545  0.08391124974833283  \\
            0.11441066609529356  0.11885133473243938  \\
            0.12258285653067168  0.16209319583374573  \\
            0.13075504696604978  0.21390665971171519  \\
            0.1389272374014279  0.2742330821804398  \\
            0.14709942783680602  0.3426857537978369  \\
            0.15527161827218414  0.41858128888053087  \\
            0.16344380870756223  0.501017119060992  \\
            0.17161599914294035  0.589028166627141  \\
            0.17978818957831846  0.6818777174672598  \\
            0.18796038001369658  0.7795478715604003  \\
            0.19613257044907467  0.8834670286529445  \\
            0.2043047608844528  0.9974203620403211  \\
            0.2124769513198309  1.128434362906478  \\
            0.22064914175520903  1.2872559795790721  \\
            0.22882133219058712  1.4879538716831269  \\
            0.23699352262596524  1.7462543781343864  \\
            0.24516571306134335  2.076533544664219  \\
            0.2533379034967215  2.4878596584623596  \\
            0.26151009393209956  2.9799543511976605  \\
            0.2696822843674777  3.5402083475920363  \\
            0.2778544748028558  4.142798886312595  \\
            0.2860266652382339  4.750492745698427  \\
            0.29419885567361204  5.3190174557557  \\
            0.3023710461089901  5.803178413089187  \\
            0.3105432365443683  6.163427248541883  \\
            0.31871542697974636  6.37149118316742  \\
            0.32688761741512445  6.413959680196767  \\
            0.3350598078505026  6.2932734064749205  \\
            0.3432319982858807  6.026184760970836  \\
            0.35140418872125884  5.640278893563576  \\
            0.3595763791566369  5.169442021352079  \\
            0.367748569592015  4.649208558831736  \\
            0.37592076002739316  4.112754033919374  \\
            0.38409295046277125  3.588014735757472  \\
            0.39226514089814934  3.096103021335368  \\
            0.4004373313335275  2.650924532399179  \\
            0.4086095217689056  2.2597318467251646  \\
            0.4167817122042837  1.9242762794827706  \\
            0.4249539026396618  1.642229075763248  \\
            0.4331260930750399  1.4086062688585446  \\
            0.44129828351041805  1.2170179434437731  \\
            0.44947047394579615  1.0606484363028978  \\
            0.45764266438117424  0.9329440449316422  \\
            0.4658148548165524  0.8280327783441552  \\
            0.47398704525193047  0.7409268800250152  \\
            0.4821592356873086  0.6675674740756243  \\
            0.4903314261226867  0.6047673813455751  \\
            0.4985036165580648  0.5500983229336629  \\
            0.506675806993443  0.5017566114446171  \\
            0.514847997428821  0.4584298244611339  \\
            0.5230201878641991  0.41917735099256237  \\
            0.5311923782995772  0.3833306078536135  \\
            0.5393645687349554  0.35041402362324703  \\
            0.5475367591703335  0.32008515195780546  \\
            0.5557089496057116  0.292090976037825  \\
            0.5638811400410897  0.2662371092737631  \\
            0.5720533304764678  0.2423667883193522  \\
            0.580225520911846  0.22034700900570472  \\
            0.5883977113472241  0.20005969078494237  \\
            0.5965699017826022  0.18139626600211403  \\
            0.6047420922179803  0.16425452702996995  \\
            0.6129142826533583  0.1485369117545069  \\
            0.6210864730887365  0.13414967003793596  \\
            0.6292586635241146  0.12100254339315582  \\
            0.6374308539594927  0.10900872249180414  \\
            0.6456030443948708  0.09808493675555051  \\
            0.6537752348302489  0.08815158927773471  \\
            0.6619474252656271  0.07913288813080589  \\
            0.6701196157010052  0.07095694869604427  \\
            0.6782918061363833  0.06355585592852664  \\
            0.6864639965717614  0.056865683806003695  \\
            0.6946361870071395  0.050826473838314006  \\
            0.7028083774425177  0.04538217687987998  \\
            0.7109805678778958  0.04048056350729254  \\
            0.7191527583132739  0.03607310846547805  \\
            0.727324948748652  0.03211485449605005  \\
            0.73549713918403  0.028564260447870374  \\
            0.7436693296194081  0.025383038054879244  \\
            0.7518415200547863  0.022535981220459918  \\
            0.7600137104901644  0.019990791110621544  \\
            0.7681859009255425  0.01771789985150025  \\
            0.7763580913609206  0.015690295160715583  \\
            0.7845302817962987  0.013883347821392156  \\
            0.7927024722316769  0.01227464353295262  \\
            0.800874662667055  0.010843820342843103  \\
            0.8090468531024331  0.009572412575757737  \\
        }
        ;
    \addlegendentry {VI estimation}
    \addplot[style={{thick, solid}}, color={green}]
        table[row sep={\\}]
        {
            \\
            0.0  0.0  \\
            0.008172190435378111  1.6843590170080242e-8  \\
            0.016344380870756223  1.7931479957148418e-6  \\
            0.024516571306134334  2.5382534037672335e-5  \\
            0.032688761741512445  0.00015728729327292565  \\
            0.04086095217689056  0.0006198288277025431  \\
            0.04903314261226867  0.0018344611356577948  \\
            0.05720533304764678  0.0044559307187813455  \\
            0.06537752348302489  0.00936619534479723  \\
            0.07354971391840301  0.017628665058553497  \\
            0.08172190435378111  0.030411467537836766  \\
            0.08989409478915923  0.04889253995634612  \\
            0.09806628522453734  0.07416007438409361  \\
            0.10623847565991545  0.10712024527860677  \\
            0.11441066609529356  0.14842125740070386  \\
            0.12258285653067168  0.19839940595857106  \\
            0.13075504696604978  0.25704963880630355  \\
            0.1389272374014279  0.32402048797756217  \\
            0.14709942783680602  0.39863169652572683  \\
            0.15527161827218414  0.47991350428561813  \\
            0.16344380870756223  0.5666718551941755  \\
            0.17161599914294035  0.657597840917056  \\
            0.17978818957831846  0.7514657992283855  \\
            0.18796038001369658  0.8474981282128176  \\
            0.19613257044907467  0.945994194644  \\
            0.2043047608844528  1.0492841424177712  \\
            0.2124769513198309  1.162932812105519  \\
            0.22064914175520903  1.2968806677354034  \\
            0.22882133219058712  1.465944670658843  \\
            0.23699352262596524  1.6889705609314487  \\
            0.24516571306134335  1.9860994837845736  \\
            0.2533379034967215  2.374153053006958  \\
            0.26151009393209956  2.8609237338062075  \\
            0.2696822843674777  3.4398706438500417  \\
            0.2778544748028558  4.087003850284356  \\
            0.2860266652382339  4.761373833467056  \\
            0.29419885567361204  5.4096250521856595  \\
            0.3023710461089901  5.973853891092562  \\
            0.3105432365443683  6.40098786610019  \\
            0.31871542697974636  6.651449817089195  \\
            0.32688761741512445  6.705124308979293  \\
            0.3350598078505026  6.563465758851345  \\
            0.3432319982858807  6.247653990509947  \\
            0.35140418872125884  5.793651861834599  \\
            0.3595763791566369  5.245591395277611  \\
            0.367748569592015  4.6490206119471456  \\
            0.37592076002739316  4.045255844548615  \\
            0.38409295046277125  3.4675739420329865  \\
            0.39226514089814934  2.9394334601124843  \\
            0.4004373313335275  2.474477443529977  \\
            0.4086095217689056  2.0778140151415463  \\
            0.4167817122042837  1.7479969240338566  \\
            0.4249539026396618  1.4791926307064558  \\
            0.4331260930750399  1.2631615751919218  \\
            0.44129828351041805  1.09084175357323  \\
            0.44947047394579615  0.9534625917263004  \\
            0.45764266438117424  0.8432164949380331  \\
            0.4658148548165524  0.753571197613239  \\
            0.47398704525193047  0.6793254263555198  \\
            0.4821592356873086  0.6165050581121988  \\
            0.4903314261226867  0.5621784321938729  \\
            0.4985036165580648  0.5142467622740808  \\
            0.506675806993443  0.47124443392705945  \\
            0.514847997428821  0.4321671849779607  \\
            0.5230201878641991  0.3963344620354595  \\
            0.5311923782995772  0.3632851011513998  \\
            0.5393645687349554  0.33270183136003323  \\
            0.5475367591703335  0.3043588107667635  \\
            0.5557089496057116  0.2780865103715477  \\
            0.5638811400410897  0.2537490526206878  \\
            0.5720533304764678  0.23123013139396387  \\
            0.580225520911846  0.21042462887154179  \\
            0.5883977113472241  0.19123388251683565  \\
            0.5965699017826022  0.17356320773490488  \\
            0.6047420922179803  0.1573207596308092  \\
            0.6129142826533583  0.1424171510181217  \\
            0.6210864730887365  0.12876546784023374  \\
            0.6292586635241146  0.11628146847403986  \\
            0.6374308539594927  0.10488384478853202  \\
            0.6456030443948708  0.09449447869903657  \\
            0.6537752348302489  0.08503866115212468  \\
            0.6619474252656271  0.07644525961135044  \\
            0.6701196157010052  0.06864683075339864  \\
            0.6782918061363833  0.061579680711388377  \\
            0.6864639965717614  0.0551838779400226  \\
            0.6946361870071395  0.04940322488983782  \\
            0.7028083774425177  0.044185194901819304  \\
            0.7109805678778958  0.03948084049083711  \\
            0.7191527583132739  0.03524467871415016  \\
            0.727324948748652  0.031434558751254255  \\
            0.73549713918403  0.028011516225452972  \\
            0.7436693296194081  0.024939618214106316  \\
            0.7518415200547863  0.022185802343465053  \\
            0.7600137104901644  0.019719712854924965  \\
            0.7681859009255425  0.017513536066365614  \\
            0.7763580913609206  0.015541837235689726  \\
            0.7845302817962987  0.013781400462660163  \\
            0.7927024722316769  0.012211072937532616  \\
            0.800874662667055  0.010811614558104032  \\
            0.8090468531024331  0.00956555368764453  \\
        }
        ;
    \addlegendentry {EM estimation}
\end{axis}
\end{tikzpicture}
