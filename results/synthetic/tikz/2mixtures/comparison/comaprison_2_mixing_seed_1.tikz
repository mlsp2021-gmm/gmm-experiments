\begin{tikzpicture}
\begin{axis}[legend style={nodes={scale=0.7, transform shape}}, legend cell align={left}, title={Inference result for M=2}, yticklabel style={/pgf/number format/fixed,
            /pgf/number format/precision=3}, grid={major}, yminorgrids={true}, tick align={outside}, xtick={0.0,0.22072883612151353,0.44145767224302707,0.6621865083645406,0.8829153444860541}, xmin={0.0}, xmax={0.8829153444860541}, scaled y ticks={false}]
    \addplot[ybar interval, fill={blue!15}, forget plot, opacity={0.6}, draw={none}, bar width={5.0e-6}]
        table[row sep={\\}]
        {
            \\
            0.1  0.08  \\
            0.11  0.08  \\
            0.12  0.2  \\
            0.13  0.32  \\
            0.14  0.28  \\
            0.15  0.32  \\
            0.16  0.52  \\
            0.17  0.64  \\
            0.18  0.72  \\
            0.19  0.68  \\
            0.2  0.88  \\
            0.21  0.92  \\
            0.22  1.2  \\
            0.23  1.16  \\
            0.24  1.56  \\
            0.25  1.68  \\
            0.26  2.32  \\
            0.27  3.8  \\
            0.28  4.32  \\
            0.29  5.16  \\
            0.3  6.36  \\
            0.31  7.44  \\
            0.32  7.88  \\
            0.33  8.52  \\
            0.34  8.12  \\
            0.35  6.84  \\
            0.36  5.44  \\
            0.37  4.44  \\
            0.38  3.6  \\
            0.39  2.0  \\
            0.4  2.28  \\
            0.41  1.4  \\
            0.42  1.08  \\
            0.43  0.88  \\
            0.44  1.08  \\
            0.45  0.4  \\
            0.46  0.36  \\
            0.47  0.52  \\
            0.48  0.6  \\
            0.49  0.56  \\
            0.5  0.52  \\
            0.51  0.36  \\
            0.52  0.28  \\
            0.53  0.28  \\
            0.54  0.36  \\
            0.55  0.16  \\
            0.56  0.2  \\
            0.57  0.2  \\
            0.58  0.16  \\
            0.59  0.08  \\
            0.6  0.12  \\
            0.61  0.04  \\
            0.62  0.08  \\
            0.63  0.0  \\
            0.64  0.08  \\
            0.65  0.04  \\
            0.66  0.12  \\
            0.67  0.08  \\
            0.68  0.0  \\
            0.69  0.0  \\
            0.7  0.04  \\
            0.71  0.0  \\
            0.72  0.0  \\
            0.73  0.0  \\
            0.74  0.0  \\
            0.75  0.0  \\
            0.76  0.0  \\
            0.77  0.0  \\
            0.78  0.04  \\
            0.79  0.04  \\
            0.8  0.04  \\
            0.81  0.0  \\
            0.82  0.0  \\
            0.83  0.0  \\
            0.84  0.0  \\
            0.85  0.0  \\
            0.86  0.0  \\
            0.87  0.0  \\
            0.88  0.04  \\
            0.89  0.0  \\
        }
        ;
    \addplot[style={{ultra thick, dotted}}, color={blue}]
        table[row sep={\\}]
        {
            \\
            0.0  0.0  \\
            0.008918336812990446  1.4659521571823196e-8  \\
            0.017836673625980893  1.8233916657538285e-6  \\
            0.026755010438971338  2.796619569583853e-5  \\
            0.035673347251961786  0.00018206250582207038  \\
            0.04459168406495223  0.000741107663128661  \\
            0.053510020877942675  0.0022415804213374592  \\
            0.06242835769093312  0.005523496619118642  \\
            0.07134669450392357  0.011714448033366572  \\
            0.08026503131691401  0.022154834771055013  \\
            0.08918336812990446  0.03827921298173601  \\
            0.0981017049428949  0.06147532315411526  \\
            0.10702004175588535  0.09294293929447839  \\
            0.11593837856887579  0.13357114600675285  \\
            0.12485671538186624  0.18384700214916883  \\
            0.1337750521948567  0.24380238796438738  \\
            0.14269338900784714  0.3130002449604372  \\
            0.15161172582083757  0.39055703167364  \\
            0.16053006263382802  0.475195445836129  \\
            0.16944839944681847  0.5653213449342154  \\
            0.17836673625980892  0.659125621765532  \\
            0.18728507307279937  0.754738534488777  \\
            0.1962034098857898  0.8505359710429155  \\
            0.20512174669878025  0.9458351002940422  \\
            0.2140400835117707  1.0423752910149222  \\
            0.22295842032476115  1.1469634174188381  \\
            0.23187675713775158  1.2751457852833568  \\
            0.24079509395074203  1.4545774593236245  \\
            0.24971343076373248  1.725326428517821  \\
            0.2586317675767229  2.133866927762795  \\
            0.2675501043897134  2.7192674069519214  \\
            0.2764684412027038  3.494148853944108  \\
            0.2853867780156943  4.427471184826784  \\
            0.2943051148286847  5.438013487902521  \\
            0.30322345164167513  6.404476587077055  \\
            0.3121417884546656  7.1912671681891505  \\
            0.32106012526765604  7.681762964212792  \\
            0.3299784620806465  7.8072361837490565  \\
            0.33889679889363694  7.56152140898522  \\
            0.34781513570662737  6.997661256356862  \\
            0.35673347251961784  6.20976284635714  \\
            0.36565180933260827  5.3078735089285  \\
            0.37457014614559875  4.394372796713  \\
            0.38348848295858917  3.547835844232969  \\
            0.3924068197715796  2.816430715244989  \\
            0.4013251565845701  2.219535694705594  \\
            0.4102434933975605  1.7544358346454452  \\
            0.419161830210551  1.4047475455382896  \\
            0.4280801670235414  1.1480709553129236  \\
            0.4369985038365318  0.9615779181937046  \\
            0.4459168406495223  0.8252852299095832  \\
            0.45483517746251273  0.7234040985668345  \\
            0.46375351427550315  0.6444011512224361  \\
            0.47267185108849363  0.5803772000560086  \\
            0.48159018790148406  0.5262113742177804  \\
            0.49050852471447454  0.4787375177480013  \\
            0.49942686152746496  0.4360740621966692  \\
            0.5083451983404554  0.3971347017861152  \\
            0.5172635351534458  0.3612989728415632  \\
            0.5261818719664363  0.32820482969743126  \\
            0.5351002087794268  0.2976255288540317  \\
            0.5440185455924172  0.2694005372962015  \\
            0.5529368824054076  0.24339895793422686  \\
            0.5618552192183981  0.21950147185755117  \\
            0.5707735560313886  0.1975922839397768  \\
            0.5796918928443789  0.17755618178884258  \\
            0.5886102296573694  0.15927803730945617  \\
            0.5975285664703599  0.14264335960018532  \\
            0.6064469032833503  0.12753920878175978  \\
            0.6153652400963407  0.11385514743059783  \\
            0.6242835769093312  0.10148409080912103  \\
            0.6332019137223216  0.09032300619311652  \\
            0.6421202505353121  0.08027345277188432  \\
            0.6510385873483026  0.07124197150993272  \\
            0.659956924161293  0.06314034132331274  \\
            0.6688752609742834  0.05588571987794105  \\
            0.6777935977872739  0.049400687045859815  \\
            0.6867119346002644  0.04361320783705435  \\
            0.6956302714132547  0.03845653004021693  \\
            0.7045486082262452  0.03386903012042519  \\
            0.7134669450392357  0.029794019257986862  \\
            0.7223852818522261  0.026179519829435623  \\
            0.7313036186652165  0.022978021157548534  \\
            0.740221955478207  0.02014622200584705  \\
            0.7491402922911975  0.017644766069498895  \\
            0.7580586291041879  0.015437975618825773  \\
            0.7669769659171783  0.013493587480327316  \\
            0.7758953027301688  0.011782494687483406  \\
            0.7848136395431592  0.010278496392319697  \\
            0.7937319763561497  0.008958057990526992  \\
            0.8026503131691402  0.007800082869019476  \\
            0.8115686499821305  0.006785696726210424  \\
            0.820486986795121  0.005898045033074134  \\
            0.8294053236081115  0.005122103888626511  \\
            0.838323660421102  0.004444504268590317  \\
            0.8472419972340923  0.0038533694630422622  \\
            0.8561603340470828  0.0033381653406683613  \\
            0.8650786708600733  0.002889562957405  \\
            0.8739970076730637  0.002499312939858671  \\
            0.8829153444860541  0.002160131013737997  \\
        }
        ;
    \addlegendentry {VI estimation}
    \addplot[style={{thick, solid}}, color={green}]
        table[row sep={\\}]
        {
            \\
            0.0  0.0  \\
            0.008918336812990446  2.6960172509501426e-9  \\
            0.017836673625980893  5.197425283648103e-7  \\
            0.026755010438971338  1.02247285678298e-5  \\
            0.035673347251961786  7.901263459401297e-5  \\
            0.04459168406495223  0.0003659108504059361  \\
            0.053510020877942675  0.001225752468345731  \\
            0.06242835769093312  0.0032837353443759053  \\
            0.07134669450392357  0.007469477651206099  \\
            0.08026503131691401  0.01499518092634398  \\
            0.08918336812990446  0.02727794675157935  \\
            0.0981017049428949  0.04581877145124161  \\
            0.10702004175588535  0.07205794396857375  \\
            0.11593837856887579  0.10722841838812801  \\
            0.12485671538186624  0.15222638624382576  \\
            0.1337750521948567  0.2075133360036131  \\
            0.14269338900784714  0.2730578902060431  \\
            0.15161172582083757  0.34831988145736675  \\
            0.16053006263382802  0.432274465967422  \\
            0.16944839944681847  0.5234721477730432  \\
            0.17836673625980892  0.6201361743318564  \\
            0.18728507307279937  0.7203250571883227  \\
            0.1962034098857898  0.8222592426578956  \\
            0.20512174669878025  0.9250443076385133  \\
            0.2140400835117707  1.030168343624964  \\
            0.22295842032476115  1.1441161123364547  \\
            0.23187675713775158  1.2819245377094588  \\
            0.24079509395074203  1.4703626429690693  \\
            0.24971343076373248  1.7480915145442715  \\
            0.2586317675767229  2.1597695277310933  \\
            0.2675501043897134  2.7427777656415353  \\
            0.2764684412027038  3.5090730146401157  \\
            0.2853867780156943  4.428831926090257  \\
            0.2943051148286847  5.4241931534225944  \\
            0.30322345164167513  6.3786594364369975  \\
            0.3121417884546656  7.161349655618531  \\
            0.32106012526765604  7.658530373619571  \\
            0.3299784620806465  7.801400222481101  \\
            0.33889679889363694  7.58072845712295  \\
            0.34781513570662737  7.04454982870803  \\
            0.35673347251961784  6.2816364367710955  \\
            0.36565180933260827  5.397873238761758  \\
            0.37457014614559875  4.493523725670442  \\
            0.38348848295858917  3.6471840708777314  \\
            0.3924068197715796  2.9086588648058087  \\
            0.4013251565845701  2.299779954221054  \\
            0.4102434933975605  1.8203490924173535  \\
            0.419161830210551  1.4560492655888144  \\
            0.4280801670235414  1.1858738096653036  \\
            0.4369985038365318  0.9877253760419828  \\
            0.4459168406495223  0.8418349492755566  \\
            0.45483517746251273  0.7322987635901346  \\
            0.46375351427550315  0.6473063560210158  \\
            0.47267185108849363  0.5786383019556569  \\
            0.48159018790148406  0.5208789103869748  \\
            0.49050852471447454  0.47062171085543064  \\
            0.49942686152746496  0.4258034340581683  \\
            0.5083451983404554  0.3852063031991761  \\
            0.5172635351534458  0.34811622227433614  \\
            0.5261818719664363  0.3141036061465098  \\
            0.5351002087794268  0.28289105336903325  \\
            0.5440185455924172  0.2542778558129951  \\
            0.5529368824054076  0.2280993814421864  \\
            0.5618552192183981  0.20420667217050742  \\
            0.5707735560313886  0.18245714486892284  \\
            0.5796918928443789  0.16271105502119976  \\
            0.5886102296573694  0.14483075106918888  \\
            0.5975285664703599  0.1286811443180408  \\
            0.6064469032833503  0.11413060075773089  \\
            0.6153652400963407  0.10105187863820568  \\
            0.6242835769093312  0.08932294937116672  \\
            0.6332019137223216  0.07882764422684284  \\
            0.6421202505353121  0.06945611835315865  \\
            0.6510385873483026  0.061105145066848644  \\
            0.659956924161293  0.053678261548770985  \\
            0.6688752609742834  0.047085789117350084  \\
            0.6777935977872739  0.041244750554580704  \\
            0.6867119346002644  0.0360787051110202  \\
            0.6956302714132547  0.0315175195552607  \\
            0.7045486082262452  0.02749709129737994  \\
            0.7134669450392357  0.023959037360282893  \\
            0.7223852818522261  0.0208503608689506  \\
            0.7313036186652165  0.018123104806683676  \\
            0.740221955478207  0.015734001060640265  \\
            0.7491402922911975  0.013644121246560847  \\
            0.7580586291041879  0.011818534458387608  \\
            0.7669769659171783  0.01022597592241964  \\
            0.7758953027301688  0.008838529535206436  \\
            0.7848136395431592  0.007631326415699238  \\
            0.7937319763561497  0.006582260890766074  \\
            0.8026503131691402  0.005671724744490782  \\
            0.8115686499821305  0.004882360081518602  \\
            0.820486986795121  0.004198830769532518  \\
            0.8294053236081115  0.003607612123043446  \\
            0.838323660421102  0.003096798258319881  \\
            0.8472419972340923  0.0026559263767909564  \\
            0.8561603340470828  0.002275817112007639  \\
            0.8650786708600733  0.0019484299946798773  \\
            0.8739970076730637  0.001666733043878571  \\
            0.8829153444860541  0.00142458547361449  \\
        }
        ;
    \addlegendentry {EM estimation}
\end{axis}
\end{tikzpicture}
