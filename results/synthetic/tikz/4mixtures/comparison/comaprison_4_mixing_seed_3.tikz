\begin{tikzpicture}
\begin{axis}[legend style={nodes={scale=0.7, transform shape}}, legend cell align={left}, title={Inference result for M=4}, yticklabel style={/pgf/number format/fixed,
            /pgf/number format/precision=3}, grid={major}, yminorgrids={true}, tick align={outside}, xtick={0.0,2.209305513540636,4.418611027081272,6.627916540621907,8.837222054162543}, xmin={0.0}, xmax={8.837222054162543}, scaled y ticks={false}]
    \addplot[ybar interval, fill={blue!15}, forget plot, opacity={0.6}, draw={none}, bar width={5.0e-6}]
        table[row sep={\\}]
        {
            \\
            1.6  0.024  \\
            1.7  0.124  \\
            1.8  0.368  \\
            1.9  0.7  \\
            2.0  0.548  \\
            2.1  0.312  \\
            2.2  0.124  \\
            2.3  0.028  \\
            2.4  0.012  \\
            2.5  0.004  \\
            2.6  0.0  \\
            2.7  0.0  \\
            2.8  0.0  \\
            2.9  0.0  \\
            3.0  0.0  \\
            3.1  0.0  \\
            3.2  0.0  \\
            3.3  0.0  \\
            3.4  0.016  \\
            3.5  0.016  \\
            3.6  0.1  \\
            3.7  0.26  \\
            3.8  0.42  \\
            3.9  0.608  \\
            4.0  0.556  \\
            4.1  0.432  \\
            4.2  0.268  \\
            4.3  0.108  \\
            4.4  0.076  \\
            4.5  0.004  \\
            4.6  0.004  \\
            4.7  0.0  \\
            4.8  0.0  \\
            4.9  0.0  \\
            5.0  0.0  \\
            5.1  0.0  \\
            5.2  0.004  \\
            5.3  0.0  \\
            5.4  0.032  \\
            5.5  0.052  \\
            5.6  0.12  \\
            5.7  0.18  \\
            5.8  0.256  \\
            5.9  0.36  \\
            6.0  0.404  \\
            6.1  0.232  \\
            6.2  0.22  \\
            6.3  0.132  \\
            6.4  0.06  \\
            6.5  0.044  \\
            6.6  0.016  \\
            6.7  0.004  \\
            6.8  0.0  \\
            6.9  0.0  \\
            7.0  0.0  \\
            7.1  0.008  \\
            7.2  0.016  \\
            7.3  0.028  \\
            7.4  0.052  \\
            7.5  0.12  \\
            7.6  0.204  \\
            7.7  0.248  \\
            7.8  0.288  \\
            7.9  0.372  \\
            8.0  0.34  \\
            8.1  0.292  \\
            8.2  0.296  \\
            8.3  0.248  \\
            8.4  0.116  \\
            8.5  0.108  \\
            8.6  0.016  \\
            8.7  0.012  \\
            8.8  0.008  \\
            8.9  0.0  \\
        }
        ;
    \addplot[style={{ultra thick, dotted}}, color={blue}]
        table[row sep={\\}]
        {
            \\
            0.0  0.0  \\
            0.08926486923396508  1.8677045447953887e-85  \\
            0.17852973846793016  7.133602600883092e-60  \\
            0.2677946077018953  1.1854366210732193e-45  \\
            0.3570594769358603  4.393807450900143e-36  \\
            0.4463243461698254  4.6023873193346255e-29  \\
            0.5355892154037906  1.1774482299734781e-23  \\
            0.6248540846377556  2.32459724302164e-19  \\
            0.7141189538717206  7.037783054626038e-16  \\
            0.8033838231056858  5.088315056473039e-13  \\
            0.8926486923396508  1.1888016283549991e-10  \\
            0.981913561573616  1.1135936920394786e-8  \\
            1.0711784308075811  4.904552871608297e-7  \\
            1.1604433000415462  1.1461945621743406e-5  \\
            1.2497081692755112  0.00015614809509098296  \\
            1.3389730385094762  0.001335993389687766  \\
            1.4282379077434413  0.0076235318652318135  \\
            1.5175027769774065  0.03047449101865491  \\
            1.6067676462113716  0.08888443400482023  \\
            1.6960325154453366  0.19571966285138462  \\
            1.7852973846793017  0.33488252164509646  \\
            1.8745622539132667  0.45634611092336885  \\
            1.963827123147232  0.5058726789458847  \\
            2.053091992381197  0.4646292584724639  \\
            2.1423568616151623  0.35929010675325096  \\
            2.231621730849127  0.23722483656009236  \\
            2.3208866000830923  0.1354054293764608  \\
            2.410151469317057  0.06755424190050895  \\
            2.4994163385510224  0.029752431365854422  \\
            2.5886812077849877  0.0116874884686621  \\
            2.6779460770189525  0.004196747275017483  \\
            2.7672109462529177  0.0016204890225273699  \\
            2.8564758154868826  0.001326637228900784  \\
            2.945740684720848  0.002643484986851213  \\
            3.035005553954813  0.006133960585871994  \\
            3.124270423188778  0.013241286131529369  \\
            3.213535292422743  0.026012863254119237  \\
            3.302800161656708  0.046622011655410016  \\
            3.3920650308906732  0.07658504398491145  \\
            3.4813299001246385  0.1158246113547016  \\
            3.5705947693586033  0.16194895347247965  \\
            3.6598596385925686  0.21016432981087615  \\
            3.7491245078265334  0.2540418182187399  \\
            3.8383893770604987  0.2869913426696015  \\
            3.927654246294464  0.3039506041381096  \\
            4.016919115528429  0.30267292070026514  \\
            4.106183984762394  0.2841663372288197  \\
            4.195448853996359  0.2521981203732008  \\
            4.2847137232303245  0.21213906074567845  \\
            4.373978592464289  0.1696139681020233  \\
            4.463243461698254  0.1293955367119951  \\
            4.552508330932219  0.0947919155308759  \\
            4.641773200166185  0.06755175041153041  \\
            4.7310380694001495  0.048144017753834395  \\
            4.820302938634114  0.03620566190976478  \\
            4.90956780786808  0.030974467272202072  \\
            4.998832677102045  0.03159609257145428  \\
            5.08809754633601  0.03727137825587616  \\
            5.177362415569975  0.04726748038669394  \\
            5.26662728480394  0.06084628006544156  \\
            5.355892154037905  0.07716948964490448  \\
            5.44515702327187  0.09522978210763951  \\
            5.5344218925058355  0.11383869979605737  \\
            5.6236867617398  0.1316809296570967  \\
            5.712951630973765  0.14742513656775602  \\
            5.802216500207731  0.15986721994582437  \\
            5.891481369441696  0.1680747950615524  \\
            5.9807462386756605  0.17150261399650338  \\
            6.070011107909626  0.17005649616009613  \\
            6.159275977143591  0.1640955462085606  \\
            6.248540846377556  0.15437557607329805  \\
            6.3378057156115215  0.14194745424450997  \\
            6.427070584845486  0.128030364029434  \\
            6.516335454079451  0.11388097323790151  \\
            6.605600323313416  0.10067608610843128  \\
            6.694865192547382  0.08942024046265719  \\
            6.7841300617813465  0.08088300542318326  \\
            6.873394931015311  0.0755651626396137  \\
            6.962659800249277  0.07368950500027954  \\
            7.051924669483242  0.07521080391127802  \\
            7.141189538717207  0.07984004531497861  \\
            7.230454407951172  0.08707943008843096  \\
            7.319719277185137  0.09626599024474504  \\
            7.408984146419102  0.10662237204957323  \\
            7.498249015653067  0.11731316456873334  \\
            7.5875138848870325  0.1275042762021854  \\
            7.676778754120997  0.13642171096610872  \\
            7.766043623354962  0.14340518048373713  \\
            7.855308492588928  0.14795172659477862  \\
            7.944573361822893  0.14974513444130744  \\
            8.033838231056858  0.14866834710943466  \\
            8.123103100290823  0.14479809189571763  \\
            8.212367969524788  0.13838310387381286  \\
            8.301632838758753  0.12980926980220212  \\
            8.390897707992718  0.11955637618053011  \\
            8.480162577226682  0.10815173535694869  \\
            8.569427446460649  0.0961257573804425  \\
            8.658692315694614  0.08397365788296719  \\
            8.747957184928579  0.0721261716355706  \\
            8.837222054162543  0.060930647021385696  \\
        }
        ;
    \addlegendentry {VI estimation}
    \addplot[style={{thick, solid}}, color={green}]
        table[row sep={\\}]
        {
            \\
            0.0  0.0  \\
            0.08926486923396508  5.071224386483445e-170  \\
            0.17852973846793016  6.099419691362954e-119  \\
            0.2677946077018953  1.5620414827513614e-90  \\
            0.3570594769358603  2.088338165977003e-71  \\
            0.4463243461698254  2.2894425373937562e-57  \\
            0.5355892154037906  1.522444568344367e-46  \\
            0.6248540846377556  6.098888951114359e-38  \\
            0.7141189538717206  5.794105109609604e-31  \\
            0.8033838231056858  3.1595029877211913e-25  \\
            0.8926486923396508  1.808222667860334e-20  \\
            0.981913561573616  1.6704515635232868e-16  \\
            1.0711784308075811  3.422947739368987e-13  \\
            1.1604433000415462  1.9805088236861966e-10  \\
            1.2497081692755112  3.903427550025927e-8  \\
            1.3389730385094762  3.040902013676187e-6  \\
            1.4282379077434413  0.00010556461896049116  \\
            1.5175027769774065  0.0018013001833498505  \\
            1.6067676462113716  0.016386545313226183  \\
            1.6960325154453366  0.085070050167257  \\
            1.7852973846793017  0.2669667410548071  \\
            1.8745622539132667  0.5319488515330749  \\
            1.963827123147232  0.7020624670807349  \\
            2.053091992381197  0.6366281898516402  \\
            2.1423568616151623  0.40952343077244824  \\
            2.231621730849127  0.19219078174575965  \\
            2.3208866000830923  0.06745154252001954  \\
            2.410151469317057  0.01809607516489477  \\
            2.4994163385510224  0.0037844070689160144  \\
            2.5886812077849877  0.0006278070541533051  \\
            2.6779460770189525  8.392525007812094e-5  \\
            2.7672109462529177  9.177609158282865e-6  \\
            2.8564758154868826  9.649244496389834e-7  \\
            2.945740684720848  1.7393769166067887e-6  \\
            3.035005553954813  1.577082577287406e-5  \\
            3.124270423188778  0.00011455733380299148  \\
            3.213535292422743  0.0006524783676031507  \\
            3.302800161656708  0.002952367559133779  \\
            3.3920650308906732  0.010744002374888066  \\
            3.4813299001246385  0.03180304547409235  \\
            3.5705947693586033  0.07737852303202188  \\
            3.6598596385925686  0.15625247752985427  \\
            3.7491245078265334  0.2642346063404631  \\
            3.8383893770604987  0.3773417734774095  \\
            3.927654246294464  0.45860465844741344  \\
            4.016919115528429  0.4778028849252378  \\
            4.106183984762394  0.4296418059532685  \\
            4.195448853996359  0.33555426100866687  \\
            4.2847137232303245  0.22897858209146824  \\
            4.373978592464289  0.1372847966309524  \\
            4.463243461698254  0.07269962446429344  \\
            4.552508330932219  0.0341814948350259  \\
            4.641773200166185  0.014372178651715374  \\
            4.7310380694001495  0.005545939653062307  \\
            4.820302938634114  0.0023128862851447456  \\
            4.90956780786808  0.0018694894472485635  \\
            4.998832677102045  0.0033199651473739527  \\
            5.08809754633601  0.007005332749758861  \\
            5.177362415569975  0.014066182646699316  \\
            5.26662728480394  0.026096532631872078  \\
            5.355892154037905  0.044689795334343245  \\
            5.44515702327187  0.07079794901891356  \\
            5.5344218925058355  0.10401567819908997  \\
            5.6236867617398  0.1420652932522346  \\
            5.712951630973765  0.1807948794343587  \\
            5.802216500207731  0.2148547343267791  \\
            5.891481369441696  0.2389310708343719  \\
            5.9807462386756605  0.24913615746767143  \\
            6.070011107909626  0.24404348583430316  \\
            6.159275977143591  0.22498867025506927  \\
            6.248540846377556  0.19556430556641177  \\
            6.3378057156115215  0.1605563387120097  \\
            6.427070584845486  0.12474544503317857  \\
            6.516335454079451  0.09197023371172813  \\
            6.605600323313416  0.06467212083650811  \\
            6.694865192547382  0.0439257676468811  \\
            6.7841300617813465  0.02980228735944944  \\
            6.873394931015311  0.021856034318183122  \\
            6.962659800249277  0.01955422193594559  \\
            7.051924669483242  0.02253923636570849  \\
            7.141189538717207  0.030687696392447315  \\
            7.230454407951172  0.04398859826073504  \\
            7.319719277185137  0.06230251193401064  \\
            7.408984146419102  0.0850877554655737  \\
            7.498249015653067  0.11118770946395447  \\
            7.5875138848870325  0.13876165115181247  \\
            7.676778754120997  0.1654065042446184  \\
            7.766043623354962  0.18846321698602897  \\
            7.855308492588928  0.20544355051988414  \\
            7.944573361822893  0.21447092085962208  \\
            8.033838231056858  0.2146192906920597  \\
            8.123103100290823  0.20606192542513616  \\
            8.212367969524788  0.18999737006974704  \\
            8.301632838758753  0.1683829592625375  \\
            8.390897707992718  0.1435546380882868  \\
            8.480162577226682  0.11783140747002659  \\
            8.569427446460649  0.09319115165505061  \\
            8.658692315694614  0.07107099240346236  \\
            8.747957184928579  0.05230439636095393  \\
            8.837222054162543  0.03717288602172983  \\
        }
        ;
    \addlegendentry {EM estimation}
\end{axis}
\end{tikzpicture}
