\begin{tikzpicture}
\begin{axis}[legend style={nodes={scale=0.7, transform shape}}, legend cell align={left}, title={Inference result for M=4}, yticklabel style={/pgf/number format/fixed,
            /pgf/number format/precision=3}, grid={major}, yminorgrids={true}, tick align={outside}, xtick={0.0,2.204874106945324,4.409748213890648,6.614622320835972,8.819496427781296}, xmin={0.0}, xmax={8.819496427781296}, scaled y ticks={false}]
    \addplot[ybar interval, fill={blue!15}, forget plot, opacity={0.6}, draw={none}, bar width={5.0e-6}]
        table[row sep={\\}]
        {
            \\
            1.5  0.008  \\
            1.6  0.024  \\
            1.7  0.096  \\
            1.8  0.368  \\
            1.9  0.584  \\
            2.0  0.584  \\
            2.1  0.316  \\
            2.2  0.1  \\
            2.3  0.032  \\
            2.4  0.004  \\
            2.5  0.004  \\
            2.6  0.0  \\
            2.7  0.0  \\
            2.8  0.0  \\
            2.9  0.0  \\
            3.0  0.0  \\
            3.1  0.0  \\
            3.2  0.0  \\
            3.3  0.004  \\
            3.4  0.008  \\
            3.5  0.052  \\
            3.6  0.08  \\
            3.7  0.288  \\
            3.8  0.504  \\
            3.9  0.656  \\
            4.0  0.512  \\
            4.1  0.504  \\
            4.2  0.292  \\
            4.3  0.104  \\
            4.4  0.056  \\
            4.5  0.012  \\
            4.6  0.008  \\
            4.7  0.0  \\
            4.8  0.0  \\
            4.9  0.0  \\
            5.0  0.0  \\
            5.1  0.0  \\
            5.2  0.004  \\
            5.3  0.008  \\
            5.4  0.004  \\
            5.5  0.068  \\
            5.6  0.052  \\
            5.7  0.124  \\
            5.8  0.16  \\
            5.9  0.2  \\
            6.0  0.172  \\
            6.1  0.18  \\
            6.2  0.12  \\
            6.3  0.056  \\
            6.4  0.06  \\
            6.5  0.024  \\
            6.6  0.004  \\
            6.7  0.0  \\
            6.8  0.0  \\
            6.9  0.0  \\
            7.0  0.0  \\
            7.1  0.004  \\
            7.2  0.0  \\
            7.3  0.028  \\
            7.4  0.092  \\
            7.5  0.068  \\
            7.6  0.252  \\
            7.7  0.408  \\
            7.8  0.4  \\
            7.9  0.584  \\
            8.0  0.512  \\
            8.1  0.424  \\
            8.2  0.3  \\
            8.3  0.228  \\
            8.4  0.136  \\
            8.5  0.088  \\
            8.6  0.028  \\
            8.7  0.008  \\
            8.8  0.004  \\
            8.9  0.0  \\
        }
        ;
    \addplot[style={{ultra thick, dotted}}, color={blue}]
        table[row sep={\\}]
        {
            \\
            0.0  0.0  \\
            0.08908582250284137  7.1861005444798e-185  \\
            0.17817164500568275  2.103648736911492e-129  \\
            0.26725746750852414  1.5031569802019435e-98  \\
            0.3563432900113655  8.998828807065604e-78  \\
            0.44542911251420686  1.6211279358347785e-62  \\
            0.5345149350170483  9.396149873537089e-51  \\
            0.6236007575198896  2.118077733013568e-41  \\
            0.712686580022731  8.219859964022028e-34  \\
            0.8017724025255724  1.4336617957760408e-27  \\
            0.8908582250284137  2.1638569671517465e-22  \\
            0.9799440475312551  4.509834169569613e-18  \\
            1.0690298700340966  1.8327111717723895e-14  \\
            1.1581156925369378  1.8872420399793237e-11  \\
            1.2472015150397793  6.036967222396423e-9  \\
            1.3362873375426205  7.050030404612437e-7  \\
            1.425373160045462  3.423530281265946e-5  \\
            1.5144589825483032  0.0007689645126427959  \\
            1.6035448050511447  0.008725479419692653  \\
            1.692630627553986  0.05385268608355091  \\
            1.7817164500568274  0.1924438194446507  \\
            1.8708022725596687  0.41999770822204474  \\
            1.9598880950625102  0.5860960870316955  \\
            2.0489739175653514  0.5441801608201345  \\
            2.138059740068193  0.34804476654407174  \\
            2.2271455625710344  0.15807623862147144  \\
            2.3162313850738756  0.05237228400307414  \\
            2.405317207576717  0.01296232971564278  \\
            2.4944030300795585  0.0024480797489584505  \\
            2.5834888525824  0.0003595613272016954  \\
            2.672574675085241  4.177635718420886e-5  \\
            2.7616604975880823  3.899212803455421e-6  \\
            2.850746320090924  2.972472951431144e-7  \\
            2.9398321425937652  4.26093184413116e-8  \\
            3.0289179650966065  4.990033963101197e-7  \\
            3.118003787599448  7.293361688517809e-6  \\
            3.2070896101022894  7.6920706062677e-5  \\
            3.2961754326051307  0.0005948706815118387  \\
            3.385261255107972  0.0034296555963822433  \\
            3.4743470776108136  0.014967672880924964  \\
            3.563432900113655  0.0501484636236954  \\
            3.652518722616496  0.13068646221925662  \\
            3.7416045451193374  0.26812250530141285  \\
            3.830690367622179  0.4379800628249209  \\
            3.9197761901250203  0.575632509876414  \\
            4.008862012627862  0.6146824059409467  \\
            4.097947835130703  0.5381897671727279  \\
            4.1870336576335445  0.38968001642040034  \\
            4.276119480136386  0.23520332654518722  \\
            4.365205302639227  0.1192342537286736  \\
            4.454291125142069  0.051126129437768876  \\
            4.5433769476449095  0.018665911943120575  \\
            4.632462770147751  0.0058389183233666115  \\
            4.721548592650593  0.001574187811425938  \\
            4.810634415153434  0.0003680639518574138  \\
            4.899720237656275  7.700128929809246e-5  \\
            4.988806060159117  2.757272652861193e-5  \\
            5.077891882661958  8.052594913362256e-5  \\
            5.1669777051648  0.000359656521573721  \\
            5.256063527667641  0.0013772866417274038  \\
            5.345149350170482  0.004441570876590798  \\
            5.434235172673324  0.012122301671367908  \\
            5.523320995176165  0.02815248400170636  \\
            5.612406817679006  0.05592101557726863  \\
            5.701492640181848  0.09547681899846586  \\
            5.790578462684689  0.14077444573143894  \\
            5.8796642851875305  0.1800519240052057  \\
            5.968750107690372  0.2006213139715383  \\
            6.057835930193213  0.1955403970710969  \\
            6.146921752696055  0.16736824256747715  \\
            6.236007575198896  0.126273007632763  \\
            6.325093397701737  0.08427593250125931  \\
            6.414179220204579  0.04992771221328575  \\
            6.50326504270742  0.026342288070674767  \\
            6.592350865210261  0.012417144279584444  \\
            6.681436687713103  0.005247482848506038  \\
            6.770522510215944  0.0020060827497448237  \\
            6.859608332718786  0.000751842235333829  \\
            6.948694155221627  0.0004982538425068116  \\
            7.037779977724468  0.0010849775489276132  \\
            7.12686580022731  0.003234629152808709  \\
            7.2159516227301514  0.008921899853358376  \\
            7.305037445232992  0.021874674634597708  \\
            7.394123267735834  0.04764360498035101  \\
            7.483209090238675  0.09241708996944886  \\
            7.5722949127415164  0.16009022326221642  \\
            7.661380735244358  0.2483079542935469  \\
            7.750466557747199  0.3457317187650699  \\
            7.839552380250041  0.4331936651059784  \\
            7.928638202752882  0.4896146877038332  \\
            8.017724025255724  0.5003302222344996  \\
            8.106809847758564  0.46329361957179827  \\
            8.195895670261406  0.389572947030271  \\
            8.284981492764247  0.29809824084577696  \\
            8.374067315267089  0.20799093208838665  \\
            8.46315313776993  0.1325843158496372  \\
            8.552238960272772  0.07736141603227048  \\
            8.641324782775612  0.04139399801359599  \\
            8.730410605278454  0.02034711043239873  \\
            8.819496427781296  0.009203832527196682  \\
        }
        ;
    \addlegendentry {VI estimation}
    \addplot[style={{thick, solid}}, color={green}]
        table[row sep={\\}]
        {
            \\
            0.0  0.0  \\
            0.08908582250284137  2.3421777641453124e-187  \\
            0.17817164500568275  3.5899559344807386e-131  \\
            0.26725746750852414  6.481176009387787e-100  \\
            0.3563432900113655  7.27453896718604e-79  \\
            0.44542911251420686  2.0864749826698705e-63  \\
            0.5345149350170483  1.7362700151089574e-51  \\
            0.6236007575198896  5.2322942821227345e-42  \\
            0.712686580022731  2.57641617251226e-34  \\
            0.8017724025255724  5.478682694159378e-28  \\
            0.8908582250284137  9.769465789629189e-23  \\
            0.9799440475312551  2.3450932085028547e-18  \\
            1.0690298700340966  1.0747859794424354e-14  \\
            1.1581156925369378  1.2263609916059491e-11  \\
            1.2472015150397793  4.2819735676725e-9  \\
            1.3362873375426205  5.387954069759677e-7  \\
            1.425373160045462  2.787500340605172e-5  \\
            1.5144589825483032  0.0006604646081720545  \\
            1.6035448050511447  0.007836500280831757  \\
            1.692630627553986  0.050179861338103496  \\
            1.7817164500568274  0.18474126546189348  \\
            1.8708022725596687  0.41275394779160585  \\
            1.9598880950625102  0.5862735473945484  \\
            2.0489739175653514  0.551170832028783  \\
            2.138059740068193  0.35522970519594915  \\
            2.2271455625710344  0.16186762398055604  \\
            2.3162313850738756  0.05358616827038043  \\
            2.405317207576717  0.013202725454826224  \\
            2.4944030300795585  0.0024735770925226755  \\
            2.5834888525824  0.0003592429412720128  \\
            2.672574675085241  4.114835225867361e-5  \\
            2.7616604975880823  3.7755732023004255e-6  \\
            2.850746320090924  2.823470984500267e-7  \\
            2.9398321425937652  4.383723991617485e-8  \\
            3.0289179650966065  5.420121354434967e-7  \\
            3.118003787599448  7.797988178255266e-6  \\
            3.2070896101022894  8.108596339565303e-5  \\
            3.2961754326051307  0.0006193901284670346  \\
            3.385261255107972  0.0035333072541478406  \\
            3.4743470776108136  0.015282178975205469  \\
            3.563432900113655  0.050823393185599364  \\
            3.652518722616496  0.13165981481791297  \\
            3.7416045451193374  0.26889528302947063  \\
            3.830690367622179  0.43783800389793887  \\
            3.9197761901250203  0.5743396362871891  \\
            4.008862012627862  0.6128706563192764  \\
            4.097947835130703  0.5368524659363906  \\
            4.1870336576335445  0.38932672530881635  \\
            4.276119480136386  0.23561382810901765  \\
            4.365205302639227  0.11988230690521168  \\
            4.454291125142069  0.05164415894550166  \\
            4.5433769476449095  0.01896104710293298  \\
            4.632462770147751  0.00597000867575799  \\
            4.721548592650593  0.0016214704788518682  \\
            4.810634415153434  0.0003822801257822741  \\
            4.899720237656275  8.087492338638616e-5  \\
            4.988806060159117  3.002056870361638e-5  \\
            5.077891882661958  8.87846780362479e-5  \\
            5.1669777051648  0.0003921405972452077  \\
            5.256063527667641  0.001484654168633167  \\
            5.345149350170482  0.004735979142168918  \\
            5.434235172673324  0.012792378542543479  \\
            5.523320995176165  0.02941639640760419  \\
            5.612406817679006  0.057884327523290376  \\
            5.701492640181848  0.09794837278642965  \\
            5.790578462684689  0.14319583779763065  \\
            5.8796642851875305  0.18167687021475148  \\
            5.968750107690372  0.20088921094648082  \\
            6.057835930193213  0.19438854354591462  \\
            6.146921752696055  0.16524702666737623  \\
            6.236007575198896  0.1238695038116044  \\
            6.325093397701737  0.08216991384390353  \\
            6.414179220204579  0.048402066794590866  \\
            6.50326504270742  0.025400483294720156  \\
            6.592350865210261  0.011913137367541678  \\
            6.681436687713103  0.0050110285295745  \\
            6.770522510215944  0.0019080906662193634  \\
            6.859608332718786  0.0007160425418680925  \\
            6.948694155221627  0.00048806660682384  \\
            7.037779977724468  0.001088317917633807  \\
            7.12686580022731  0.0032566562040948184  \\
            7.2159516227301514  0.008987288620041518  \\
            7.305037445232992  0.02203588043014914  \\
            7.394123267735834  0.047985830949868996  \\
            7.483209090238675  0.09304516006907952  \\
            7.5722949127415164  0.16108523723920856  \\
            7.661380735244358  0.24966022860298517  \\
            7.750466557747199  0.3472849961772627  \\
            7.839552380250041  0.4346493576344526  \\
            7.928638202752882  0.4906201477062936  \\
            8.017724025255724  0.5006188787823906  \\
            8.106809847758564  0.46280020650312803  \\
            8.195895670261406  0.3884557368541525  \\
            8.284981492764247  0.29665932987085425  \\
            8.374067315267089  0.2065478431205806  \\
            8.46315313776993  0.13136489968966206  \\
            8.552238960272772  0.07646402886005793  \\
            8.641324782775612  0.04080860337358636  \\
            8.730410605278454  0.02000488290505261  \\
            8.819496427781296  0.009023177263404089  \\
        }
        ;
    \addlegendentry {EM estimation}
\end{axis}
\end{tikzpicture}
