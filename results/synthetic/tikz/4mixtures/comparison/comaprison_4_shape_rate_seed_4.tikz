\begin{tikzpicture}
\begin{axis}[legend style={nodes={scale=0.7, transform shape}}, legend cell align={left}, title={Inference result for M=4}, yticklabel style={/pgf/number format/fixed,
            /pgf/number format/precision=3}, grid={major}, yminorgrids={true}, tick align={outside}, xtick={0.0,2.211035404129275,4.42207080825855,6.633106212387824,8.8441416165171}, xmin={0.0}, xmax={8.8441416165171}, scaled y ticks={false}]
    \addplot[ybar interval, fill={blue!15}, forget plot, opacity={0.6}, draw={none}, bar width={5.0e-6}]
        table[row sep={\\}]
        {
            \\
            1.6  0.024  \\
            1.7  0.14  \\
            1.8  0.296  \\
            1.9  0.496  \\
            2.0  0.444  \\
            2.1  0.288  \\
            2.2  0.116  \\
            2.3  0.04  \\
            2.4  0.0  \\
            2.5  0.0  \\
            2.6  0.0  \\
            2.7  0.0  \\
            2.8  0.0  \\
            2.9  0.0  \\
            3.0  0.0  \\
            3.1  0.0  \\
            3.2  0.0  \\
            3.3  0.004  \\
            3.4  0.016  \\
            3.5  0.036  \\
            3.6  0.164  \\
            3.7  0.248  \\
            3.8  0.424  \\
            3.9  0.488  \\
            4.0  0.512  \\
            4.1  0.316  \\
            4.2  0.244  \\
            4.3  0.112  \\
            4.4  0.036  \\
            4.5  0.012  \\
            4.6  0.004  \\
            4.7  0.0  \\
            4.8  0.0  \\
            4.9  0.0  \\
            5.0  0.0  \\
            5.1  0.0  \\
            5.2  0.0  \\
            5.3  0.004  \\
            5.4  0.052  \\
            5.5  0.076  \\
            5.6  0.132  \\
            5.7  0.368  \\
            5.8  0.432  \\
            5.9  0.46  \\
            6.0  0.42  \\
            6.1  0.344  \\
            6.2  0.236  \\
            6.3  0.184  \\
            6.4  0.072  \\
            6.5  0.028  \\
            6.6  0.016  \\
            6.7  0.008  \\
            6.8  0.0  \\
            6.9  0.004  \\
            7.0  0.0  \\
            7.1  0.004  \\
            7.2  0.004  \\
            7.3  0.028  \\
            7.4  0.08  \\
            7.5  0.108  \\
            7.6  0.144  \\
            7.7  0.2  \\
            7.8  0.324  \\
            7.9  0.364  \\
            8.0  0.424  \\
            8.1  0.328  \\
            8.2  0.264  \\
            8.3  0.176  \\
            8.4  0.116  \\
            8.5  0.068  \\
            8.6  0.048  \\
            8.7  0.016  \\
            8.8  0.008  \\
            8.9  0.0  \\
        }
        ;
    \addplot[style={{ultra thick, dotted}}, color={blue}]
        table[row sep={\\}]
        {
            \\
            0.0  0.0  \\
            0.08933476380320302  2.0206463209384905e-187  \\
            0.17866952760640603  3.56300340554177e-131  \\
            0.2680042914096091  6.876300310142017e-100  \\
            0.35733905521281206  8.00620902439046e-79  \\
            0.4466738190160151  2.3431629389769353e-63  \\
            0.5360085828192181  1.9690206750761212e-51  \\
            0.6253433466224212  5.949038777340395e-42  \\
            0.7146781104256241  2.921508264417669e-34  \\
            0.8040128742288272  6.171040294787091e-28  \\
            0.8933476380320302  1.089600862581672e-22  \\
            0.9826824018352333  2.583195505758149e-18  \\
            1.0720171656384363  1.1668095606666906e-14  \\
            1.1613519294416392  1.3097995022173022e-11  \\
            1.2506866932448424  4.492429354831826e-9  \\
            1.3400214570480453  5.545555449678463e-7  \\
            1.4293562208512482  2.8114238823529094e-5  \\
            1.5186909846544514  0.0006521048360096938  \\
            1.6080257484576543  0.007567672805140627  \\
            1.6973605122608575  0.0473586579640718  \\
            1.7866952760640604  0.17027706539025073  \\
            1.8760300398672634  0.37130293145641263  \\
            1.9653648036704665  0.5144352846250108  \\
            2.0546995674736697  0.47149898949365543  \\
            2.1440343312768726  0.2961134984350491  \\
            2.2333690950800755  0.1314228066805955  \\
            2.3227038588832785  0.04235920506074273  \\
            2.4120386226864814  0.010157316289767826  \\
            2.5013733864896848  0.0018514372213636614  \\
            2.5907081502928877  0.0002615161353917794  \\
            2.6800429140960906  2.9124438131608275e-5  \\
            2.7693776778992936  2.597569900409335e-6  \\
            2.8587124417024965  1.9045328106213302e-7  \\
            2.9480472055057  7.11658439587075e-8  \\
            3.037381969308903  1.0925941016086309e-6  \\
            3.1267167331121057  1.4162065210457476e-5  \\
            3.2160514969153087  0.00013328734368127802  \\
            3.3053862607185116  0.0009265248470526988  \\
            3.394721024521715  0.004834482972620858  \\
            3.484055788324918  0.01921942381555748  \\
            3.573390552128121  0.059021320333093395  \\
            3.6627253159313238  0.1418056220077866  \\
            3.7520600797345267  0.2697312676600078  \\
            3.84139484353773  0.41067389013399996  \\
            3.930729607340933  0.5056338475227641  \\
            4.020064371144136  0.5082694303754496  \\
            4.109399134947339  0.4208650156865036  \\
            4.198733898750542  0.28947093854470485  \\
            4.288068662553745  0.16667632876586685  \\
            4.377403426356948  0.08093442150719796  \\
            4.466738190160151  0.033371335796612  \\
            4.556072953963354  0.011760013894360818  \\
            4.645407717766557  0.0035635760430538354  \\
            4.73474248156976  0.000934008335773753  \\
            4.824077245372963  0.0002138140432070017  \\
            4.913412009176167  5.0130118131488704e-5  \\
            5.0027467729793695  5.7014072848273624e-5  \\
            5.0920815367825725  0.0002637163907613659  \\
            5.181416300585775  0.001156224618350523  \\
            5.270751064388978  0.004260047119738832  \\
            5.360085828192181  0.013217036209453083  \\
            5.449420591995384  0.03472305293842448  \\
            5.538755355798587  0.07766287705713822  \\
            5.62809011960179  0.1486473970122319  \\
            5.717424883404993  0.24466976134657595  \\
            5.806759647208197  0.34794790217680016  \\
            5.8960944110114  0.42943535137899347  \\
            5.985429174814603  0.46193647365027857  \\
            6.074763938617806  0.4348470905213396  \\
            6.1640987024210085  0.3596269398004604  \\
            6.2534334662242115  0.2622694256033042  \\
            6.342768230027414  0.1692670797611901  \\
            6.432102993830617  0.09700884263864827  \\
            6.52143775763382  0.04953221300892246  \\
            6.610772521437023  0.02260340867739618  \\
            6.700107285240227  0.00924879943119087  \\
            6.78944204904343  0.0034148419771974697  \\
            6.878776812846633  0.0011939667249243528  \\
            6.968111576649836  0.0006044090134323168  \\
            7.057446340453039  0.0010268652605434651  \\
            7.146781104256242  0.002908798413639362  \\
            7.236115868059445  0.007867293028889742  \\
            7.3254506318626476  0.018962150724509276  \\
            7.4147853956658505  0.04060339683407379  \\
            7.504120159469053  0.07742314340393747  \\
            7.593454923272257  0.13182182998152098  \\
            7.68278968707546  0.20093757945792284  \\
            7.772124450878663  0.27491789114190673  \\
            7.861459214681866  0.33844305205950653  \\
            7.950793978485069  0.37579012417312774  \\
            8.040128742288273  0.3772106468271825  \\
            8.129463506091476  0.34305977278280125  \\
            8.218798269894679  0.2832954651343126  \\
            8.308133033697882  0.2128627861720728  \\
            8.397467797501085  0.14582345819447537  \\
            8.486802561304287  0.09125821375408755  \\
            8.57613732510749  0.05227044038714245  \\
            8.665472088910693  0.027452197011879363  \\
            8.754806852713896  0.013243641234149476  \\
            8.8441416165171  0.005878900751770243  \\
        }
        ;
    \addlegendentry {VI estimation}
    \addplot[style={{thick, solid}}, color={green}]
        table[row sep={\\}]
        {
            \\
            0.0  0.0  \\
            0.08933476380320302  2.213924837255566e-186  \\
            0.17866952760640603  1.9163799178157242e-130  \\
            0.2680042914096091  2.487320947078253e-99  \\
            0.35733905521281206  2.215598515056425e-78  \\
            0.4466738190160151  5.323843035870222e-63  \\
            0.5360085828192181  3.840891129311845e-51  \\
            0.6253433466224212  1.0274850058905147e-41  \\
            0.7146781104256241  4.5696396165994325e-34  \\
            0.8040128742288272  8.893314372617345e-28  \\
            0.8933476380320302  1.4665836658362098e-22  \\
            0.9826824018352333  3.2832743490353294e-18  \\
            1.0720171656384363  1.4132022295542438e-14  \\
            1.1613519294416392  1.5232647880642512e-11  \\
            1.2506866932448424  5.049385461781106e-9  \\
            1.3400214570480453  6.057869624537853e-7  \\
            1.4293562208512482  2.999409059432662e-5  \\
            1.5186909846544514  0.0006823722250492722  \\
            1.6080257484576543  0.007796651247524296  \\
            1.6973605122608575  0.04820100089894206  \\
            1.7866952760640604  0.17172836019083615  \\
            1.8760300398672634  0.37207718018028474  \\
            1.9653648036704665  0.5134912748598937  \\
            2.0546995674736697  0.46985480322180784  \\
            2.1440343312768726  0.29520310719528126  \\
            2.2333690950800755  0.13132247603434302  \\
            2.3227038588832785  0.04249939317894951  \\
            2.4120386226864814  0.01024906032444365  \\
            2.5013733864896848  0.0018816401310128214  \\
            2.5907081502928877  0.00026807427081680874  \\
            2.6800429140960906  3.0151483875033073e-5  \\
            2.7693776778992936  2.7191831296997867e-6  \\
            2.8587124417024965  2.0122610219721066e-7  \\
            2.9480472055057  6.208387127929778e-8  \\
            3.037381969308903  9.49076319452905e-7  \\
            3.1267167331121057  1.2732121119333685e-5  \\
            3.2160514969153087  0.00012342570834991847  \\
            3.3053862607185116  0.000879607312127712  \\
            3.394721024521715  0.004684652067101269  \\
            3.484055788324918  0.018929687605587994  \\
            3.573390552128121  0.05885185657576888  \\
            3.6627253159313238  0.14261019541108302  \\
            3.7520600797345267  0.2726033385576816  \\
            3.84139484353773  0.4156714169979241  \\
            3.930729607340933  0.5108828661344305  \\
            4.020064371144136  0.5110391026960526  \\
            4.109399134947339  0.4198366884046126  \\
            4.198733898750542  0.28567894968962665  \\
            4.288068662553745  0.16229064516447259  \\
            4.377403426356948  0.07754588376131649  \\
            4.466738190160151  0.031384174478243446  \\
            4.556072953963354  0.010829431324605461  \\
            4.645407717766557  0.003205787861104822  \\
            4.73474248156976  0.0008190227842227745  \\
            4.824077245372963  0.0001826843783941182  \\
            4.913412009176167  4.418505604087041e-5  \\
            5.0027467729793695  6.350631689719537e-5  \\
            5.0920815367825725  0.000301776403888772  \\
            5.181416300585775  0.0013080285547703745  \\
            5.270751064388978  0.004757504788719106  \\
            5.360085828192181  0.01456821646815234  \\
            5.449420591995384  0.037768990486492744  \\
            5.538755355798587  0.08335207828617287  \\
            5.62809011960179  0.15739393618749908  \\
            5.717424883404993  0.25555405899566835  \\
            5.806759647208197  0.3584547218528725  \\
            5.8960944110114  0.43629770724625755  \\
            5.985429174814603  0.46278735478226396  \\
            6.074763938617806  0.4295368577493338  \\
            6.1640987024210085  0.3502133630333638  \\
            6.2534334662242115  0.2517666273545559  \\
            6.342768230027414  0.16015765261859144  \\
            6.432102993830617  0.09046220535724317  \\
            6.52143775763382  0.045517810198243684  \\
            6.610772521437023  0.020467419385687843  \\
            6.700107285240227  0.008251319918403237  \\
            6.78944204904343  0.0030010477160180814  \\
            6.878776812846633  0.0010334367286187818  \\
            6.968111576649836  0.0005201920605674576  \\
            7.057446340453039  0.00090061528797689  \\
            7.146781104256242  0.002590271385660108  \\
            7.236115868059445  0.007091590003138185  \\
            7.3254506318626476  0.01729506008574559  \\
            7.4147853956658505  0.03747236619524587  \\
            7.504120159469053  0.07230206557639218  \\
            7.593454923272257  0.12457098359657068  \\
            7.68278968707546  0.1921580804701091  \\
            7.772124450878663  0.2660641082521817  \\
            7.861459214681866  0.33149132230411305  \\
            7.950793978485069  0.372522295619794  \\
            8.040128742288273  0.37846688867828937  \\
            8.129463506091476  0.3483911440870375  \\
            8.218798269894679  0.2912099868275536  \\
            8.308133033697882  0.22148857916335668  \\
            8.397467797501085  0.15359576048305715  \\
            8.486802561304287  0.09730586188081189  \\
            8.57613732510749  0.056422594738510405  \\
            8.665472088910693  0.029999789321572032  \\
            8.754806852713896  0.014652332337909168  \\
            8.8441416165171  0.006585177786695539  \\
        }
        ;
    \addlegendentry {EM estimation}
\end{axis}
\end{tikzpicture}
