\begin{tikzpicture}
\begin{axis}[legend style={nodes={scale=0.7, transform shape}}, legend cell align={left}, title={Inference result for M=3}, yticklabel style={/pgf/number format/fixed,
            /pgf/number format/precision=3}, grid={major}, yminorgrids={true}, tick align={outside}, xtick={0.0,3.728483447836641,7.456966895673282,11.185450343509922,14.913933791346563}, xmin={0.0}, xmax={14.913933791346563}, scaled y ticks={false}]
    \addplot[ybar interval, fill={blue!15}, forget plot, opacity={0.6}, draw={none}, bar width={5.0e-6}]
        table[row sep={\\}]
        {
            \\
            1.0  0.004  \\
            1.2  0.028  \\
            1.4  0.13  \\
            1.6  0.25  \\
            1.8  0.286  \\
            2.0  0.374  \\
            2.2  0.216  \\
            2.4  0.12  \\
            2.6  0.052  \\
            2.8  0.036  \\
            3.0  0.016  \\
            3.2  0.066  \\
            3.4  0.036  \\
            3.6  0.06  \\
            3.8  0.058  \\
            4.0  0.06  \\
            4.2  0.058  \\
            4.4  0.052  \\
            4.6  0.084  \\
            4.8  0.06  \\
            5.0  0.042  \\
            5.2  0.058  \\
            5.4  0.07  \\
            5.6  0.064  \\
            5.8  0.058  \\
            6.0  0.056  \\
            6.2  0.066  \\
            6.4  0.052  \\
            6.6  0.04  \\
            6.8  0.06  \\
            7.0  0.038  \\
            7.2  0.046  \\
            7.4  0.03  \\
            7.6  0.03  \\
            7.8  0.036  \\
            8.0  0.046  \\
            8.2  0.036  \\
            8.4  0.046  \\
            8.6  0.066  \\
            8.8  0.088  \\
            9.0  0.104  \\
            9.2  0.154  \\
            9.4  0.206  \\
            9.6  0.212  \\
            9.8  0.25  \\
            10.0  0.204  \\
            10.2  0.222  \\
            10.4  0.128  \\
            10.6  0.11  \\
            10.8  0.1  \\
            11.0  0.09  \\
            11.2  0.038  \\
            11.4  0.032  \\
            11.6  0.024  \\
            11.8  0.014  \\
            12.0  0.01  \\
            12.2  0.008  \\
            12.4  0.002  \\
            12.6  0.002  \\
            12.8  0.002  \\
            13.0  0.002  \\
            13.2  0.002  \\
            13.4  0.002  \\
            13.6  0.0  \\
            13.8  0.002  \\
            14.0  0.002  \\
            14.2  0.0  \\
            14.4  0.002  \\
            14.6  0.0  \\
            14.8  0.002  \\
            15.0  0.0  \\
        }
        ;
    \addplot[style={{ultra thick, dotted}}, color={blue}]
        table[row sep={\\}]
        {
            \\
            0.0  0.0  \\
            0.15064579587218752  0.0008214024886576719  \\
            0.30129159174437503  0.0037467796545690487  \\
            0.45193738761656255  0.008589912965818585  \\
            0.6025831834887501  0.014859222423606282  \\
            0.7532289793609376  0.022028101897817516  \\
            0.9038747752331251  0.02961846077254776  \\
            1.0545205711053125  0.03722983372139279  \\
            1.2051663669775001  0.044545680368243835  \\
            1.3558121628496875  0.05132922156462359  \\
            1.5064579587218752  0.05741460496184727  \\
            1.6571037545940626  0.06269636062280463  \\
            1.8077495504662502  0.06711870687909677  \\
            1.9583953463384376  0.0706655160394512  \\
            2.109041142210625  0.07335132841246964  \\
            2.2596869380828126  0.07521356197419625  \\
            2.4103327339550003  0.07630592735208962  \\
            2.560978529827188  0.07669298158911697  \\
            2.711624325699375  0.07644571509714732  \\
            2.8622701215715627  0.07563804971628145  \\
            3.0129159174437503  0.0743441228671802  \\
            3.1635617133159375  0.07263623777267829  \\
            3.314207509188125  0.07058336909221156  \\
            3.4648533050603127  0.06825012518605911  \\
            3.6154991009325004  0.06569608472365178  \\
            3.7661448968046876  0.06297546961847052  \\
            3.916790692676875  0.060137309617177635  \\
            4.067436488549062  0.057227050542388594  \\
            4.21808228442125  0.05429314802093491  \\
            4.368728080293438  0.05140842464229831  \\
            4.519373876165625  0.04872594169749728  \\
            4.670019672037813  0.0465950022806384  \\
            4.8206654679100005  0.045743988738598765  \\
            4.971311263782188  0.04747064743494974  \\
            5.121957059654376  0.05367912877483465  \\
            5.2726028555265625  0.06654634990244926  \\
            5.42324865139875  0.0877043753725252  \\
            5.573894447270938  0.11712561045961384  \\
            5.724540243143125  0.15223982423006477  \\
            5.875186039015313  0.18790929726085456  \\
            6.025831834887501  0.21755803033748042  \\
            6.176477630759688  0.23512869499022443  \\
            6.327123426631875  0.23703045304280257  \\
            6.477769222504063  0.2232034297440496  \\
            6.62841501837625  0.19688869586641394  \\
            6.779060814248438  0.16333981708798143  \\
            6.9297066101206255  0.12814515429333795  \\
            7.080352405992813  0.0958522514396839  \\
            7.230998201865001  0.06928393683554991  \\
            7.381643997737188  0.04955213391076393  \\
            7.532289793609375  0.03651745835582177  \\
            7.682935589481563  0.029380469235100928  \\
            7.83358138535375  0.027172562992367276  \\
            7.984227181225938  0.029045476456455832  \\
            8.134872977098125  0.03436505795241274  \\
            8.285518772970313  0.04266994516224221  \\
            8.4361645688425  0.05356630723473488  \\
            8.586810364714689  0.066615983244618  \\
            8.737456160586875  0.08125443858525282  \\
            8.888101956459064  0.09675605796583465  \\
            9.03874775233125  0.11224992665761847  \\
            9.189393548203437  0.12677897744168562  \\
            9.340039344075626  0.13938840259094765  \\
            9.490685139947812  0.14922533646765707  \\
            9.641330935820001  0.1556311757116083  \\
            9.791976731692188  0.1582105144660569  \\
            9.942622527564376  0.1568659639844669  \\
            10.093268323436563  0.15179494551164419  \\
            10.243914119308752  0.14345142639668673  \\
            10.394559915180938  0.13248113241088103  \\
            10.545205711053125  0.1196420697924725  \\
            10.695851506925314  0.10572290320970054  \\
            10.8464973027975  0.09147014159385343  \\
            10.997143098669689  0.07753189999001649  \\
            11.147788894541875  0.06442213773586246  \\
            11.298434690414064  0.052505573041432455  \\
            11.44908048628625  0.042000565439502695  \\
            11.599726282158437  0.0329954592395147  \\
            11.750372078030626  0.0254732186360946  \\
            11.901017873902813  0.019339465642667215  \\
            12.051663669775001  0.014449945306904521  \\
            12.202309465647188  0.010634657059781834  \\
            12.352955261519377  0.007717124014694212  \\
            12.503601057391563  0.005528327756219085  \\
            12.65424685326375  0.003915613058533137  \\
            12.804892649135938  0.002747343922970255  \\
            12.955538445008125  0.0019143040938443935  \\
            13.106184240880314  0.0013288461788453056  \\
            13.2568300367525  0.0009226756182787027  \\
            13.407475832624689  0.000643973539004849  \\
            13.558121628496876  0.0004543652874903218  \\
            13.708767424369064  0.00032606124504557074  \\
            13.859413220241251  0.00023935009144434796  \\
            14.010059016113438  0.00018051703949863832  \\
            14.160704811985626  0.00014018820230569674  \\
            14.311350607857813  0.0001120607209190323  \\
            14.461996403730002  9.19588491545272e-5  \\
            14.612642199602188  7.715156806804843e-5  \\
            14.763287995474377  6.587148367479787e-5  \\
            14.913933791346563  5.6983310597080966e-5  \\
        }
        ;
    \addlegendentry {VI estimation}
    \addplot[style={{thick, solid}}, color={green}]
        table[row sep={\\}]
        {
            \\
            0.0  0.0  \\
            0.15064579587218752  8.445698707896878e-9  \\
            0.30129159174437503  5.241296761109101e-7  \\
            0.45193738761656255  5.434289237920015e-6  \\
            0.6025831834887501  2.7092766714389495e-5  \\
            0.7532289793609376  9.2318776363869e-5  \\
            0.9038747752331251  0.0003194271151801955  \\
            1.0545205711053125  0.001854430589028946  \\
            1.2051663669775001  0.011053953223676461  \\
            1.3558121628496875  0.04452356641092935  \\
            1.5064579587218752  0.1191060812454098  \\
            1.6571037545940626  0.2243737673401345  \\
            1.8077495504662502  0.3151190010701501  \\
            1.9583953463384376  0.34589770112428186  \\
            2.109041142210625  0.30872462052634303  \\
            2.2596869380828126  0.23235613268184238  \\
            2.4103327339550003  0.15361590014324883  \\
            2.560978529827188  0.09464967793817664  \\
            2.711624325699375  0.0597515316431384  \\
            2.8622701215715627  0.0433732302074084  \\
            3.0129159174437503  0.03809746211982907  \\
            3.1635617133159375  0.03837420151816662  \\
            3.314207509188125  0.04101715216648915  \\
            3.4648533050603127  0.04448055482498085  \\
            3.6154991009325004  0.04809118193592911  \\
            3.7661448968046876  0.05156745978949084  \\
            3.916790692676875  0.05478504480690825  \\
            4.067436488549062  0.05768019027940175  \\
            4.21808228442125  0.06021465265033854  \\
            4.368728080293438  0.062364060003367756  \\
            4.519373876165625  0.06411412047748559  \\
            4.670019672037813  0.06545911842086634  \\
            4.8206654679100005  0.06640095503394196  \\
            4.971311263782188  0.06694825859615033  \\
            5.121957059654376  0.06711546826411532  \\
            5.2726028555265625  0.06692189598572937  \\
            5.42324865139875  0.066390792165777  \\
            5.573894447270938  0.06554844095537968  \\
            5.724540243143125  0.0644233064294334  \\
            5.875186039015313  0.06304524568645307  \\
            6.025831834887501  0.06144480044317459  \\
            6.176477630759688  0.05965257646167344  \\
            6.327123426631875  0.05769872385047776  \\
            6.477769222504063  0.05561255056893685  \\
            6.62841501837625  0.053422357986854595  \\
            6.779060814248438  0.05115572126337421  \\
            6.9297066101206255  0.04884070582628866  \\
            7.080352405992813  0.04650896218823226  \\
            7.230998201865001  0.04420224242169718  \\
            7.381643997737188  0.0419844065769229  \\
            7.532289793609375  0.0399609154132069  \\
            7.682935589481563  0.03830636153097665  \\
            7.83358138535375  0.03729707070419341  \\
            7.984227181225938  0.03734021780107999  \\
            8.134872977098125  0.03898467296732333  \\
            8.285518772970313  0.04289499089903376  \\
            8.4361645688425  0.049772463450001275  \\
            8.586810364714689  0.06021870441622897  \\
            8.737456160586875  0.07455704287020351  \\
            8.888101956459064  0.09264948566095334  \\
            9.03874775233125  0.11376292194430719  \\
            9.189393548203437  0.13653839325018638  \\
            9.340039344075626  0.1590973141816439  \\
            9.490685139947812  0.17928231806155795  \\
            9.641330935820001  0.19498946682657725  \\
            9.791976731692188  0.20451779149637295  \\
            9.942622527564376  0.2068533467218636  \\
            10.093268323436563  0.2018217345347578  \\
            10.243914119308752  0.19007925178683668  \\
            10.394559915180938  0.17295552994636607  \\
            10.545205711053125  0.15219564698917204  \\
            10.695851506925314  0.12966734508451644  \\
            10.8464973027975  0.10709658494176733  \\
            10.997143098669689  0.08587652451133544  \\
            11.147788894541875  0.0669694786135527  \\
            11.298434690414064  0.05089717161688716  \\
            11.44908048628625  0.0377977291900225  \\
            11.599726282158437  0.027520655393298385  \\
            11.750372078030626  0.01973241244314635  \\
            11.901017873902813  0.014012082570308046  \\
            12.051663669775001  0.009925447476429533  \\
            12.202309465647188  0.00707390192764233  \\
            12.352955261519377  0.005120383102056848  \\
            12.503601057391563  0.003797575796502508  \\
            12.65424685326375  0.0029044711663936715  \\
            12.804892649135938  0.002296691780711941  \\
            12.955538445008125  0.0018746298834685497  \\
            13.106184240880314  0.0015719684544035035  \\
            13.2568300367525  0.0013459089082764762  \\
            13.407475832624689  0.0011695463119112876  \\
            13.558121628496876  0.0010263041765170382  \\
            13.708767424369064  0.0009060887654159998  \\
            13.859413220241251  0.0008027532183781158  \\
            14.010059016113438  0.0007124928450067303  \\
            14.160704811985626  0.0006328663104582269  \\
            14.311350607857813  0.0005622179137527236  \\
            14.461996403730002  0.0004993463523511388  \\
            14.612642199602188  0.0004433193828633237  \\
            14.763287995474377  0.00039337195379054876  \\
            14.913933791346563  0.00034885064849894757  \\
        }
        ;
    \addlegendentry {EM estimation}
\end{axis}
\end{tikzpicture}
