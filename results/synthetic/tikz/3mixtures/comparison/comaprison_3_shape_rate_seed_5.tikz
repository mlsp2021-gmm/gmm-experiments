\begin{tikzpicture}
\begin{axis}[legend style={nodes={scale=0.7, transform shape}}, legend cell align={left}, title={Inference result for M=3}, yticklabel style={/pgf/number format/fixed,
            /pgf/number format/precision=3}, grid={major}, yminorgrids={true}, tick align={outside}, xtick={0.0,4.2532541232415015,8.506508246483003,12.759762369724506,17.013016492966006}, xmin={0.0}, xmax={17.013016492966006}, scaled y ticks={false}]
    \addplot[ybar interval, fill={blue!15}, forget plot, opacity={0.6}, draw={none}, bar width={5.0e-6}]
        table[row sep={\\}]
        {
            \\
            0.4  0.002  \\
            0.6  0.0  \\
            0.8  0.0  \\
            1.0  0.008  \\
            1.2  0.028  \\
            1.4  0.104  \\
            1.6  0.342  \\
            1.8  0.424  \\
            2.0  0.426  \\
            2.2  0.246  \\
            2.4  0.134  \\
            2.6  0.068  \\
            2.8  0.062  \\
            3.0  0.054  \\
            3.2  0.064  \\
            3.4  0.082  \\
            3.6  0.058  \\
            3.8  0.076  \\
            4.0  0.088  \\
            4.2  0.072  \\
            4.4  0.078  \\
            4.6  0.092  \\
            4.8  0.08  \\
            5.0  0.108  \\
            5.2  0.096  \\
            5.4  0.088  \\
            5.6  0.082  \\
            5.8  0.08  \\
            6.0  0.062  \\
            6.2  0.058  \\
            6.4  0.054  \\
            6.6  0.072  \\
            6.8  0.064  \\
            7.0  0.048  \\
            7.2  0.056  \\
            7.4  0.06  \\
            7.6  0.036  \\
            7.8  0.048  \\
            8.0  0.052  \\
            8.2  0.036  \\
            8.4  0.04  \\
            8.6  0.048  \\
            8.8  0.052  \\
            9.0  0.076  \\
            9.2  0.078  \\
            9.4  0.086  \\
            9.6  0.138  \\
            9.8  0.146  \\
            10.0  0.134  \\
            10.2  0.112  \\
            10.4  0.12  \\
            10.6  0.062  \\
            10.8  0.06  \\
            11.0  0.046  \\
            11.2  0.024  \\
            11.4  0.026  \\
            11.6  0.01  \\
            11.8  0.008  \\
            12.0  0.004  \\
            12.2  0.008  \\
            12.4  0.006  \\
            12.6  0.006  \\
            12.8  0.002  \\
            13.0  0.004  \\
            13.2  0.0  \\
            13.4  0.002  \\
            13.6  0.002  \\
            13.8  0.0  \\
            14.0  0.002  \\
            14.2  0.002  \\
            14.4  0.0  \\
            14.6  0.0  \\
            14.8  0.0  \\
            15.0  0.0  \\
            15.2  0.0  \\
            15.4  0.002  \\
            15.6  0.0  \\
            15.8  0.0  \\
            16.0  0.004  \\
            16.2  0.0  \\
            16.4  0.0  \\
            16.6  0.0  \\
            16.8  0.0  \\
            17.0  0.002  \\
            17.2  0.0  \\
        }
        ;
    \addplot[style={{ultra thick, dotted}}, color={blue}]
        table[row sep={\\}]
        {
            \\
            0.0  0.0  \\
            0.17184865144410108  7.237044239028868e-5  \\
            0.34369730288820216  0.001396487910084307  \\
            0.5155459543323032  0.006776292849805157  \\
            0.6873946057764043  0.018684899894493037  \\
            0.8592432572205053  0.037800105067987755  \\
            1.0310919086646064  0.062867096670932  \\
            1.2029405601087075  0.09133695385421285  \\
            1.3747892115528086  0.12019866815117518  \\
            1.5466378629969098  0.14666742777025746  \\
            1.7184865144410106  0.1686085252411978  \\
            1.8903351658851117  0.18470590604897918  \\
            2.062183817329213  0.19444088610019253  \\
            2.234032468773314  0.19795752031868485  \\
            2.405881120217415  0.1958795707103546  \\
            2.577729771661516  0.1891249758063435  \\
            2.7495784231056173  0.1787452674160001  \\
            2.9214270745497184  0.16580292750926529  \\
            3.0932757259938195  0.1512898206392533  \\
            3.26512437743792  0.13608369412003535  \\
            3.4369730288820213  0.1209359285642911  \\
            3.6088216803261224  0.10648111679891419  \\
            3.7806703317702235  0.09325726609131746  \\
            3.9525189832143246  0.08172489220280066  \\
            4.124367634658426  0.07227483474590582  \\
            4.296216286102527  0.06521876143498588  \\
            4.468064937546628  0.06076255756031457  \\
            4.639913588990729  0.058969526351264304  \\
            4.81176224043483  0.05972537372179827  \\
            4.983610891878931  0.06271845128251784  \\
            5.155459543323032  0.06744596988702214  \\
            5.3273081947671335  0.07325065026768193  \\
            5.499156846211235  0.0793845177726998  \\
            5.671005497655336  0.08508967038983986  \\
            5.842854149099437  0.0896818078904685  \\
            6.014702800543538  0.09262201301803925  \\
            6.186551451987639  0.09356543011730029  \\
            6.35840010343174  0.09238087268996514  \\
            6.53024875487584  0.08914138544592977  \\
            6.702097406319941  0.0840909055346081  \\
            6.8739460577640425  0.07759546258236044  \\
            7.045794709208144  0.07008858447311384  \\
            7.217643360652245  0.062020165223090624  \\
            7.389492012096346  0.053816894210559685  \\
            7.561340663540447  0.045861353153928835  \\
            7.733189314984548  0.03849622097645387  \\
            7.905037966428649  0.032058173538841536  \\
            8.07688661787275  0.026939614380507487  \\
            8.248735269316851  0.023661946818198887  \\
            8.420583920760953  0.022922972068909885  \\
            8.592432572205054  0.025563775957326555  \\
            8.764281223649155  0.03240589562434286  \\
            8.936129875093256  0.04395304395573479  \\
            9.107978526537357  0.060027813553742336  \\
            9.279827177981458  0.07948744058812084  \\
            9.45167582942556  0.10018271358704414  \\
            9.62352448086966  0.11925734892059632  \\
            9.795373132313761  0.13374770626449042  \\
            9.967221783757862  0.14130032436920578  \\
            10.139070435201964  0.1407559361581825  \\
            10.310919086646065  0.13239446857615877  \\
            10.482767738090166  0.11777290334707897  \\
            10.654616389534267  0.09924510003779202  \\
            10.826465040978368  0.07935465290109633  \\
            10.99831369242247  0.06030173291741228  \\
            11.17016234386657  0.043616711444247815  \\
            11.342010995310671  0.030073807419888694  \\
            11.513859646754772  0.019795091311082643  \\
            11.685708298198874  0.012455368919427756  \\
            11.857556949642975  0.007501677452418773  \\
            12.029405601087076  0.004330255283341636  \\
            12.201254252531177  0.0023985704112937474  \\
            12.373102903975278  0.0012764046887305696  \\
            12.54495155541938  0.0006533118710767234  \\
            12.71680020686348  0.0003219881597017608  \\
            12.88864885830758  0.0001529811143506311  \\
            13.06049750975168  7.014892480519509e-5  \\
            13.232346161195782  3.108409420251969e-5  \\
            13.404194812639883  1.3329981249747174e-5  \\
            13.576043464083984  5.542689900685953e-6  \\
            13.747892115528085  2.2408078164238292e-6  \\
            13.919740766972186  8.847008286037241e-7  \\
            14.091589418416287  3.4371921580944075e-7  \\
            14.263438069860388  1.3320052941361253e-7  \\
            14.43528672130449  5.270198859603731e-8  \\
            14.60713537274859  2.2061096993941798e-8  \\
            14.778984024192692  1.0186160758589371e-8  \\
            14.950832675636793  5.331928609140547e-9  \\
            15.122681327080894  3.146535742880788e-9  \\
            15.294529978524995  2.0287819187878e-9  \\
            15.466378629969096  1.3808116530686124e-9  \\
            15.638227281413197  9.680461181902217e-10  \\
            15.810075932857298  6.8932111927004e-10  \\
            15.9819245843014  4.949393045550196e-10  \\
            16.1537732357455  3.5702497642916607e-10  \\
            16.3256218871896  2.5825136185365925e-10  \\
            16.497470538633703  1.8712514507031946e-10  \\
            16.669319190077804  1.3573571265230343e-10  \\
            16.841167841521905  9.852549338682218e-11  \\
            17.013016492966006  7.154336521343382e-11  \\
        }
        ;
    \addlegendentry {VI estimation}
    \addplot[style={{thick, solid}}, color={green}]
        table[row sep={\\}]
        {
            \\
            0.0  0.0  \\
            0.17184865144410108  1.0244570223789888e-14  \\
            0.34369730288820216  2.2001079470565546e-9  \\
            0.5155459543323032  1.4246966766644051e-6  \\
            0.6873946057764043  8.472220640104154e-5  \\
            0.8592432572205053  0.0013612248814343874  \\
            1.0310919086646064  0.009557895819128262  \\
            1.2029405601087075  0.03790608348871419  \\
            1.3747892115528086  0.09896494641577334  \\
            1.5466378629969098  0.18775559146303555  \\
            1.7184865144410106  0.27692923028779254  \\
            1.8903351658851117  0.3332581209090117  \\
            2.062183817329213  0.3391879017886637  \\
            2.234032468773314  0.3002649052975685  \\
            2.405881120217415  0.2366743622256952  \\
            2.577729771661516  0.16990926275747273  \\
            2.7495784231056173  0.11424297787468338  \\
            2.9214270745497184  0.07516384867884773  \\
            3.0932757259938195  0.05197190280409182  \\
            3.26512437743792  0.041172753847582344  \\
            3.4369730288820213  0.038872396509732614  \\
            3.6088216803261224  0.041884662467055016  \\
            3.7806703317702235  0.0479604857964563  \\
            3.9525189832143246  0.05562077312544499  \\
            4.124367634658426  0.06390354194687933  \\
            4.296216286102527  0.07215946870532053  \\
            4.468064937546628  0.07992387105112035  \\
            4.639913588990729  0.08684979088984042  \\
            4.81176224043483  0.09267836114569689  \\
            4.983610891878931  0.09722750502802653  \\
            5.155459543323032  0.10038724328540685  \\
            5.3273081947671335  0.10211558247616932  \\
            5.499156846211235  0.10243254751099724  \\
            5.671005497655336  0.10141189039028016  \\
            5.842854149099437  0.09917095115512968  \\
            6.014702800543538  0.0958595050157421  \\
            6.186551451987639  0.09164847238748133  \\
            6.35840010343174  0.08671925313446184  \\
            6.53024875487584  0.08125426475738826  \\
            6.702097406319941  0.07542907901537291  \\
            6.8739460577640425  0.0694064269516864  \\
            7.045794709208144  0.06333238390169967  \\
            7.217643360652245  0.05733543693150751  \\
            7.389492012096346  0.051530105544848825  \\
            7.561340663540447  0.04602836474639266  \\
            7.733189314984548  0.04096359523490706  \\
            7.905037966428649  0.036531094996116086  \\
            8.07688661787275  0.03304313258084372  \\
            8.248735269316851  0.0309829446026747  \\
            8.420583920760953  0.031023880999546713  \\
            8.592432572205054  0.03396802832633896  \\
            8.764281223649155  0.040569152399773656  \\
            8.936129875093256  0.05124778686055502  \\
            9.107978526537357  0.06577221939589445  \\
            9.279827177981458  0.08303498034943341  \\
            9.45167582942556  0.10105886972661919  \\
            9.62352448086966  0.11729850211896035  \\
            9.795373132313761  0.1291837290277111  \\
            9.967221783757862  0.134737883122173  \\
            10.139070435201964  0.13305831272554255  \\
            10.310919086646065  0.12449599734925923  \\
            10.482767738090166  0.1104901852970699  \\
            10.654616389534267  0.09314260681059955  \\
            10.826465040978368  0.07469487438233505  \\
            10.99831369242247  0.05707583098570548  \\
            11.17016234386657  0.041626751297755296  \\
            11.342010995310671  0.029029822500526926  \\
            11.513859646754772  0.019397516404737643  \\
            11.685708298198874  0.012447994974030008  \\
            11.857556949642975  0.007694228230315171  \\
            12.029405601087076  0.0045982941599144195  \\
            12.201254252531177  0.002671017229600014  \\
            12.373102903975278  0.001519322953067315  \\
            12.54495155541938  0.0008553127505580385  \\
            12.71680020686348  0.0004834643821442042  \\
            12.88864885830758  0.0002792928721297418  \\
            13.06049750975168  0.00016789828047528388  \\
            13.232346161195782  0.00010640687366834127  \\
            13.404194812639883  7.131804910476811e-5  \\
            13.576043464083984  5.020304922056962e-5  \\
            13.747892115528085  3.665502545296614e-5  \\
            13.919740766972186  2.7406998217096406e-5  \\
            14.091589418416287  2.0775396353161975e-5  \\
            14.263438069860388  1.5858636244651995e-5  \\
            14.43528672130449  1.2140537132924668e-5  \\
            14.60713537274859  9.299732746232446e-6  \\
            14.778984024192692  7.119312679210979e-6  \\
            14.950832675636793  5.443510869926325e-6  \\
            15.122681327080894  4.155971209029863e-6  \\
            15.294529978524995  3.167882201668146e-6  \\
            15.466378629969096  2.4107618136571855e-6  \\
            15.638227281413197  1.8315996928084592e-6  \\
            15.810075932857298  1.3893361466252431e-6  \\
            15.9819245843014  1.0521973115807992e-6  \\
            16.1537732357455  7.956347514811426e-7  \\
            16.3256218871896  6.007182363928258e-7  \\
            16.497470538633703  4.5287885388204853e-7  \\
            16.669319190077804  3.409264854134822e-7  \\
            16.841167841521905  2.562830369032674e-7  \\
            17.013016492966006  1.923853397411117e-7  \\
        }
        ;
    \addlegendentry {EM estimation}
\end{axis}
\end{tikzpicture}
